var __rest,WSB;(function(n){class t{static init(){t.aadVerificationContainer=_ge("aadVerificationContainer");t.dialogBox=_ge("dialogBox");t.dynamicPaneWrapper=_ge("dsb-wrapper");t.dynamicPane=_ge("dynamic-pane");t.msbDsbSwitch=_ge("msb_dsb_switch");t.msbDsbBrTop=_ge("msb_dsb_brtop");t.msbDsbRoot=_ge("msb_dsb_root");t.dynamicPaneFullWidth=_ge("dynamic-pane-full");t.flyoutContainer=_ge("flyoutContainer");t.footer=_ge("footer");t.groups=_ge("groups");t.menuContainer=_ge("menuContainer");t.narratorMessageContainer=_ge("narratorMessageContainer");t.overlayContainer=_ge("overlayContainer");t.performanceWidget=_ge("performanceWidget");t.popoverContainer=_ge("popoverContainer");t.qfContainer=_ge("qfContainer");t.qfContainerScroll=_ge("qfContainerScroll");t.qfPreviewPane=_ge("qfPreviewPane");t.qfPreviewScrollArea=_ge("qfPreviewScrollArea");t.root=_ge("root");t.rootContainer=_ge("rootContainer");t.scopesHeader=_ge("scopesHeader");t.shimmerContainer=n.config.showShimmerOnDismiss?_ge("shimmerContainer"):undefined;t.suggestionsList=_ge("suggestionsList");t.topHitHeader=_ge("topHitHeader");t.topResults=_ge("topResults");t.workUpsellBanner=_ge("workUpsellBanner");t.messageBannerBottom=_ge("messageBannerBottom");t.messageBannerTop=_ge("messageBanner");t.notificationBanner=_ge("notificationBanner");t.chatIframe=_ge("qf-chat");t.copilotChat=_ge("copilot-chat-container");t.copilotLoadingScreen=_ge("copilotLoadingScreen");t.copilotPaneContainer=_ge("copilotPaneContainer");t.horizontalScrollBar=_ge("horizontalScrollBar");t.temporaryMessages=_ge("temporaryMessages")}}n.StaticHtmlElements=t})(WSB||(WSB={})),function(n){function r(){if(n.config.limitScaleRange){let t=1;if(SearchAppWrapper.CortanaApp.textScaleFactor>n.MaxTextScaleThres?t=n.MaxTextScaleThres/SearchAppWrapper.CortanaApp.textScaleFactor:SearchAppWrapper.CortanaApp.textScaleFactor<n.MinTextScaleThres&&(t=n.MinTextScaleThres/SearchAppWrapper.CortanaApp.textScaleFactor),t!=1){const n=`${t*100}%`;document.body.style.zoom=n}else document.body.style.zoom=""}}function f(){if(!n.isMiniSerpEnabled())return 0;let t=7;return n.config.allowAnswersToAutoOpenMiniSerp||(t&=-2),n.config.allowDNavToAutoOpenMiniSerp||(t&=-3),n.config.allowWebToAutoOpenMiniSerp||(t&=-5),t}n.limitTextScaleRange=r;class t{}t.QuickAccess=n.config.newQuickAccess?"::{F874310E-B6B7-47DC-BC84-B9E6B38F5903}":"::{679F85CB-0220-4080-B29B-5540CC05AAB6}";t.ThisPC="::{20D04FE0-3AEA-1069-A2D8-08002B30309D}";t.ControlPanel="::{26EE0668-A00A-44D7-9371-BEB064C98683}";const u=[t.QuickAccess,t.ThisPC];class i{constructor(){this.refreshSetting();this.refreshEntrypointApp()}refreshEntrypointApp(){SearchAppWrapper.CortanaApp.hostingEnvironment==3?this.EntryPointApp=1:n.config.forceSettingsAppExperience?this.EntryPointApp=3:(this.EntryPointApp=0,this.AlwaysWide=this.isAlwaysWide(),n.config.initSearchHomeAvailable&&(this.SearchHomeAvailable=n.config.searchHomeSupported))}refreshSetting(){i.TextScaleFactor=SearchAppWrapper.CortanaApp.textScaleFactor;r();const n=SearchAppWrapper.CortanaApp.queryFormulationView.searchHistory;i.DeviceHistoryEnabled=n&&n.isDeviceHistoryEnabled}clearDefaults(){this.QfMode=0;this.PreviewPaneAvailable=!1;this.MiniSERPMode=0;this.AlwaysWide=!1;this.SearchBoxOnTop=!0;this.AllowKeyboardNavCycling=!0;this.AllowKeyboardNavOffCanvas=!1;this.ScopesAvailable=!1;this.FlatListWithoutGroups=!1;this.MaxSuggestionsWhenFlatList=0;this.SearchHomeAvailable=undefined;this.FirstSuggestionSelectedByDefault=!0;this.AllowProtocolSyntheticSuggestions=!0;this.PanelCanResize=!1}isAlwaysWide(){if(n.config.wsbWithCopilotQF)return!1;let t=i.TextScaleFactor>1.25;n.config.disbaleWideForLargeTextScale&&(t=!1);let r=!1;try{r=SearchAppWrapper.CortanaApp.isWideSearch}catch(f){}let u=r!==!1;return(u||n.config.alwaysWideBeforeRS5)&&!t}getAlwaysWideAndPrevewPaneAvailable(){let u=i.TextScaleFactor>1.25;n.config.disbaleWideForLargeTextScale&&(u=!1);let t;try{t=SearchAppWrapper.CortanaApp.isWideSearch}catch(o){}let r;r=n.config.useCobaltCSS?t!==!1:t!==!1&&!!n.Host.getFeatureDWORD("WideAtStartupDelta").featureValue;let f=(r||n.config.alwaysWideBeforeRS5)&&!u,e=f||n.PreviewPane&&!r&&t!==!1;return[f,e]}OnAppVisible(){this.clearDefaults();this.refreshSetting();this.refreshEntrypointApp();n.isFileExplorerCurrentPathThisPcOrQuickAccess=!1;switch(this.EntryPointApp){case 1:let i=n.safeExecute(()=>SearchAppWrapper.CortanaApp.fileExplorerSuggestionPage.currentLocation,"fileExplorerSuggestionPage.currentLocation");i&&!i.startsWith("::")?this.QfMode=5:n.config.wsbInControlPanel&&i&&i.startsWith(t.ControlPanel)?this.QfMode=9:n.contains(u,i)?(n.isFileExplorerCurrentPathThisPcOrQuickAccess=!0,this.QfMode=5):this.QfMode=999999;this.AllowKeyboardNavOffCanvas=!0;this.FlatListWithoutGroups=!0;this.MaxSuggestionsWhenFlatList=10;this.FirstSuggestionSelectedByDefault=!1;this.AllowProtocolSyntheticSuggestions=!1;this.PanelCanResize=!0;break;case 3:this.QfMode=7;this.FlatListWithoutGroups=!0;this.MaxSuggestionsWhenFlatList=10;this.AllowProtocolSyntheticSuggestions=!1;break;case 0:default:{const i=n.config.enableFindInStart&&SearchAppWrapper.CortanaApp.entryPoint=="WNSFIS",[t,r]=i?[!0,!1]:this.getAlwaysWideAndPrevewPaneAvailable();this.QfMode=i?11:t?1:r?0:4;this.PreviewPaneAvailable=i?!1:t||r;this.MiniSERPMode=this.PreviewPaneAvailable?f():0;this.AlwaysWide=t;let u;u=n.shouldUseMsbEnterpriseScopes()?t?n.config.scopesOrderBeginAlwaysWideMsbEnterprise.length>0:n.config.scopesOrderBeginMsbEnterprise.length>0:t?n.config.scopesOrderBeginAlwaysWide.length>0:n.config.scopesOrderBegin.length>0;this.ScopesAvailable=u;this.SearchBoxOnTop=!1;this.SearchHomeAvailable=n.config.searchHomeSupported;n.config.wsbWithCopilotQF&&(this.AlwaysWide=!1,this.PreviewPaneAvailable=!1,this.MiniSERPMode=0)}}}}n.RuntimeConfiguration=i}(WSB||(WSB={})),function(n){var t;(function(n){let t;(function(n){n.User="SRCHHPGUSR"})(t=n.CookieNames||(n.CookieNames={}));let i;(function(n){n.AutoSuggest="AS"})(i=n.CrumbNames||(n.CrumbNames={}));let r;(function(n){n.CursorPosition="cp";n.ConversationId="cvid";n.LogicalId="logicalId";n.SuggestionCount="sc";n.PartialQuery="pq";n.SuggestionPosition="sp";n.SuggestionType="qs";n.PreviewPaneSuggestionType="qsc";n.SkipValue="sk";n.PreviewPaneSkipValue="skc";n.Ghosting="ghc";n.Css="css";n.Count="count";n.DataSet="ds";n.SessionId="sid";n.TimeStamp="qt";n.Query="q";n.ImpressionGuid="ig";n.QFQuery="qry";n.BaseQuery="bq";n.FormCode="form";n.HashedMuid="nclid";n.RequestElToken="elvr";n.ElTokenValue="elv";n.AppId="appid";n.History="history";n.NoHistory="nohs";n.ApiTextDecoration="textdecorations";n.ClientId="clientid";n.Market="mkt";n.Scope="scope";n.CountryCode="cc";n.HomeGeographicRegion="hgr";n.SetLang="setlang";n.ZeroInputSerp="zis";n.Host="host";n.CortanaVersion="version";n.QfMode="qfm";n.SearchHistorySettingOff="seahisoff"})(r=n.QueryParams||(n.QueryParams={}));let u;(function(n){n.ImpressionGuid="X-MSEdge-IG"})(u=n.Headers||(n.Headers={}));let f;(function(n){n.HitHighlighting="h";n.PopularNow="p";n.Local="l";n.Answers="a"})(f=n.Options||(n.Options={}));let e;(function(n){n.Id="id";n.Query="query";n.Url="url";n.Navigation="nav";n.Type="stype";n.Autocomplete="hc";n.InstData="h";n.AriaLabel="aria-label"})(e=n.SuggestionAttributes||(n.SuggestionAttributes={}))})(t=n.Service||(n.Service={}))}(WSB||(WSB={})),function(n){function ii(t,i){if(i){let i=nt.exec(t);return i&&n.TopLevelDomains[i[1].toLowerCase()]==1}return nt.test(t)}function ri(n){return gt.test(n)}function fi(t){let r=t.substr(1).split("%").map(n=>parseInt(n,16));for(var i=0;i<r.length;++i){let t=[r[i],r[i+1]||0,r[i+2]||0,r[i+3]||0];if(t[0]>=240&&++i&&t[3]<128||t[0]>=224&&++i&&t[2]<128||t[0]>=192&&++i&&t[1]<128||t[0]<192&&t[0]>=128||t[0]<32||n.contains(ui,t[0]))return!1}return!0}function ei(n){return n.replace(/%25/g,"%2525").replace(/%([^0-9a-fA-F])/g,"%25$1").replace(/%([^0-9a-fA-F])/g,"%25$1").replace(/%(.[^0-9a-fA-F])/g,"%25$1").replace(/%(.[^0-9a-fA-F])/g,"%25$1").replace(/%(.)?$/g,"%25$1").match(/[^%]+|(?:%..)*/g).map(n=>n.startsWith("%")&&!fi(n)?n.replace(/%/g,"%25"):n).join("")}function h(t){let i=t;return t.includes("%")&&(t=n.safeExecute(()=>ei(t),"sanitizeUrlEncodings",i,i)),n.safeExecute(()=>decodeURI(t),"safeDecodeURI",i,i)}function r(n,t){if(!n)return null;if(n=n.trim(),n.includes("%")&&c(n))if(n.includes("?")){let[,t,i]=/([^?]*)(.*)/.exec(n);t=h(t);n=t+i}else n=h(n);let r=bt.exec(n);if(!r)return null;let u=r[0].length;if(t&&u<n.length)return null;let i={length:u,type:0,protocol:r[1]||"",auth:r[2]||"",hostname:r[3]||"",port:r[4]||"",path:r[5]||"",parameters:r[6]||"",unparsedSegment:n.substr(u)};return i.auth&&!i.auth.includes(":")&&!i.protocol&&!i.port&&!i.path&&!i.parameters?null:i.protocol||i.path&&i.path.endsWith("/")?i:kt.test(i.hostname)||ii(i.hostname,t)||w.test(i.hostname)||k.test(i.hostname)?i:(i.type=i.path&&!ri(i.path)?1:2,i)}function it(n,t){let r=new RegExp("[?&]{1}"+t+"=([^&]+)([\\/\\\\][^?#]*)?([?#].*)?","i"),i=n.match(r);return i?i[1]:null}function ci(n){return si.some(t=>n.startsWith(t))||oi.test(n)||n.toLocaleLowerCase().includes(hi)}function li(n,t,i){let e=0,o=0,s=0;(t.startsWith("read:")||t.startsWith("ftp:"))&&(t=t.replace(f,""));let u=r(t,!0);u&&u.type==0&&(e=vi(i,u),o=rt(i,t,u),s=yi(i,u));n.protocolMatchLength=e;n.domainMatchLength=o;n.pathMatchLength=s}function ai(n,t){let u=0;(n.startsWith("read:")||n.startsWith("ftp:"))&&(n=n.replace(f,""));let i=r(n,!0);return i&&i.type==0&&(u=rt(t,n,i)),u}function vi(n,t){let i=f.exec(n),r=i?i[1]:n.trim();return t.protocol.startsWith(r)?r.length:0}function rt(t,i,r){if(w.test(r.hostname)||k.test(r.hostname))return r.hostname.startsWith(t)||i.startsWith(t)?t.length:0;let u=r.hostname.split("."),f;if(u.length==1)f=HitHighlightingParser.addMarkers(u[0],t);else{u=u.length>2&&n.SecondLevelDomains[u[u.length-2]]?u.splice(0,u.length-2):u.splice(0,u.length-1);let i=u.join(".");f=HitHighlightingParser.addMarkers(i,t)}let e=f.indexOf(HitHighlightingParser.startMarker);if(e==-1)return 0;if(t.includes("."))return t.endsWith("/")&&(t=t.substr(0,t.length-1)),r.hostname.includes(t)?t.length:0;let o=f.indexOf(HitHighlightingParser.endMarker);return o-e-1}function yi(n,t){if(!t.path)return 0;let i=HitHighlightingParser.addMarkers(t.path,n),r=i.indexOf(HitHighlightingParser.startMarker);if(r==-1)return 0;let u=i.indexOf(HitHighlightingParser.endMarker);return u-r-1}function pi(n){return n=ft(n,!1),dt.test(n)}function ut(n){return f.test(n)}function wi(n){return a.test(n)}function c(n){return pt.test(n)}function bi(n){return ut(n)&&!c(n)}function ki(n){let t;return t=typeof n=="string"?n:l(n,!0),t=gi(t),t.trim().replace(/^ht+p(s)?[:;]+[\\\/]*|^\/*/ig,(n,t)=>t?"https://":"http://")}function ft(n,t){return t?n.includes("/")||(n=n.replace(/\\/g,"/")):n.startsWith("//")||n.includes("\\")||(n=n.replace(/\//g,"\\")),n}function di(n){return n=ft(n,!0).replace(/\/+/g,"/"),(n.startsWith("/")?"file:/":"file:///")+n}function gi(n){if(!n||!n.includes("\\"))return n;let i=n.includes("?")?n.indexOf("?"):n.length,r=n.includes("#")?n.indexOf("#"):n.length,t=Math.min(i,r),u=n.substring(0,t),f=n.substr(t);return u.replace(/\\/g,"/")+f}function l(n,t){let i=n.protocol?n.protocol:"";return i+=!t&&n.auth?n.auth:"",i+=n.hostname,i+=n.port?n.port:"",i+=n.path?n.path:"",i+=n.parameters?n.parameters:"",i+(n.unparsedSegment?n.unparsedSegment:"")}function i(n,t){let i=n;if(t&1){let n=et.exec(i);n&&(i=n[1])}if(t&2){let n=ot.exec(i);n&&(i=n[1])}if(t&4){let n=st.exec(i);n&&(i=n[1])}if(t&8){let n=a.exec(i);n&&(i=n[1])}if(t&16){let n=nr.exec(i);n&&(i=n[1])}if(t&32){let n=r(i,!1);if(n){n.protocol=n.protocol.toLocaleLowerCase();n.hostname=n.hostname.toLocaleLowerCase();let t=l(n);i=i.replace(/^(\s*)(?:[^\s]*)(\s*)$/g,"$1"+t+"$2")}}return t&64&&(i=h(i)),i}function tr(n){return a.test(n)}function e(n){return ot.test(n)?1:et.test(n)?2:st.test(n)?3:0}function ir(n,t,r){if(t){if(t=="/")return n;let f=i(t,7);if(f!=t)return n;let u=i(n,r?7:6);if(!u)return n;let o=t.toLowerCase();if("https".startsWith(o)&&!u.startsWith(t))return n;let s=i(f,8);if(s!=f)return u;let e=i(u,8);return e?"www".startsWith(o)&&!e.startsWith(t)?u:e:u}return i(n,r?15:14)||n}function rr(n,t){let i=e(t);switch(e(n)){case 1:return i!=2;case 2:return i!=1;case 3:case 0:return!0}}function ur(t,r,u){if(i(r,127)!=i(u,127))return!1;let f=e(t.originalQuery);return n.contains([1,2],f)&&!rr(r,u)?!1:!0}function ht(n){let t=r(n,!0);if(!t)return null;let i=v(t);return i?t.path.toLocaleLowerCase():null}function v(n){let t=n.hostname.split(".");return n.hostname&&t.length>1?t[t.length-1]=="com"&&fr.some(n=>t[t.length-2]==n):!0}function er(n){let i=!1,t=n.hostname.toLowerCase().split(".");return n.hostname&&t.length>1&&(i=(t[t.length-1]=="com"||t[t.length-1]=="cn")&&t[t.length-2]=="msn"),i}function or(t){if(t=="https://www.bing.com/?form=EDGSTP&pc=MESP"||t=="https://www.bing.com/?form=EDGSTP&pc=MESPB")return!0;let i=ht(t);return!!i&&n.contains(n.WebSearchPaths,i)}async function sr(t,i){let r=!1;if(await new Promise(t=>{n.LocalDataProvider.getAppsByDisplayName(n.CopilotDisplayName,i=>{r=Object.values(i).reduce((n,t)=>n.concat(t),[]).some(t=>t.deviceItem.displayName===n.CopilotDisplayName[0]),t()})}),r){const r=new URL(t);let n=r.searchParams.get("q");n?(n=encodeURIComponent(n),t=`ms-copilot:chat?q=${n}&ref=wsb&form=${i}`):t=`ms-copilot:chat?ref=wsb&form=${i}`}return t}function hr(n){let t=n.match(/^https:\/\/www\.bing\.com\/search\?q=([^&]*)&/);return t&&t[1]?t[1].split("+").join(" "):null}function cr(n){let t=r(n.replace(/^ftp:/g,"http:"),!0);return(t?t.hostname:null)||""}function lr(t){let r=t.queryToFetch.toLocaleLowerCase();if(!r)return!1;let u=i(r,15);return!u||n.contains(["/","ht","htt","http","https","ww","www"],r)||u!=r&&"www".startsWith(i(r,7))}function ar(n){if(yt.test(n)||f.test(n))return!0;let t=n.replace(ni,"/");ti.test(t)?t=t.replace(tt,"."):t.includes(".")&&(t=t.replace(tt,""));let i=r(t,!0);return i&&i.type==0}function vr(n){return n.replace(/[;,/?:@&=+$ ]/g,n=>`%${n.charCodeAt(0).toString(16)}`)}function yr(n,t,i){return v(r(n,!0))?lt(ct(n,i),t):n}function ct(n,t){return o(n,"setlang",t)}function lt(n,t){return o(n,"cc",t)}function o(n,t,i){const{params:u,anchor:f}=pr(n);var r=u,e=it(u,t);return e==null?r=n.indexOf("?")>=0?r.concat(`&${t}=${i}`):r.concat(`?${t}=${i}`):(r=r.replace(new RegExp(`${t}=${e}`,"i"),""),r=o(r,t,i)),f.length>0&&(r=r.concat("#",f)),r=r.replace("?&","?"),r.replace("&&","&")}function pr(n){var t=n.split("#");return t.length==2?{params:t[0],anchor:t[1]}:{params:t[0],anchor:""}}const u="\\-\\s\\[\\]\\/\\\\!@#$%^&*()+={}:;~`\"'|<,>.。?",at="(?:[^"+u+"]-*)*[^"+u+"](?:-*[^"+u+"])*",y="(?:[^"+u+"]-*)*[^"+u+"0-9](?:-*[^"+u+"])*",vt="(?:(?:"+at+"[.。])*"+y+")[.。]?",p="(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])",s="(?:(?:"+p+"\\.){3}"+p+")",w=new RegExp("^"+s+"$"),t="(?:[0-9a-fA-F]{1,4})",b="(?::(?:(?::"+t+"){1,7}|:)|(?:"+t+":){1,7}:|(?:"+t+":){7}"+t+"|(?:"+t+":){1,6}(?::"+t+"){1}|(?:"+t+":){1,5}(?::"+t+"){2}|(?:"+t+":){1,4}(?::"+t+"){3}|(?:"+t+":){1,3}(?::"+t+"){4}|(?:"+t+":){1,2}(?::"+t+"){5}|(?:"+t+":){1,1}(?::"+t+"){6}|fe80:(?::"+t+"){0,4}%[0-9]+|::ffff:"+s+"|)",k=new RegExp("^\\["+b+"\\]$","i"),d="ht+ps?[:;]+[\\\\/]*",yt=new RegExp(d,"i"),g=d+"|/+",pt=new RegExp("^("+g+")","i"),wt=vt+"|"+s+"|\\["+b+"\\]",bt=new RegExp("^("+g+")?([^/@#?]*@)?("+wt+")(:(?:6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{1,4}|[1-9][0-9]{0,3}))?([\\/\\\\][^?#]*)?([?#].*)?","i"),kt=/^localhost[.。]?$/,nt=new RegExp("[.。]("+y+")[.。]?$","i"),dt=/((^[\\]{2}).+)|(^[a-z]:\\.*)/i,f=/^([a-z0-9\-]+):/i,gt=/\s/,tt=/\s+/g,ni=/\s+\/(?!\/)/g,ti=/([^\/]|^)\/(?!\/)/;n.WebSearchPaths=["/search","/entityexplore"];const ui=[33,39,40,41,42,91,93];n.tryParseUrl=r;n.getQueryStringParam=it;const oi=/file:\/\/\/[^:\/]+:\/[^\/]+\/[^\/]+\/AppData\//i,si=["ms-appx:","ms-appx-web:","ms-browser-extension:",],hi="microsoft.microsoftedge_8wekyb3d8bbwe";n.isJunkUrl=ci;n.computeUrlMatchLengths=li;n.computeDomainlMatchLength=ai;n.isUncOrLocalPath=pi;n.startsWithProtocol=ut;n.startsWithWww=wi;n.isHttpProtocol=c;n.isNonHttpProtocol=bi;n.cleanAndFixUrlProtocol=ki;n.cleanAndFixUncOrLocalPath=di;n.parsedUrlToString=l;const et=/^ht+ps:\/*(.*)/i,ot=/^ht+p:\/*(.*)/i,st=/^\/{2,}(.*)/,a=/^www\.(.*)/i,nr=/^(.*[^:\/])\/+$/;n.normalizeUrl=i;n.hasWww=tr;n.getProtocol=e;n.prettyPrintUrl=ir;n.isDuplicateUrl=ur;let fr=["bing","staging-bing-int","working-bing-int","bing-int","bing-exp","binginternal"];n.tryGetBingPathLC=ht;n.isBingHost=v;n.isMsnHost=er;n.isBingSearchUrl=or;n.getCopilotLaunchUrl=sr;n.extractQueryFromBingSearchUrl=hr;n.getDomain=cr;n.isEmptyUrlPrefix=lr;n.queryLooksLikeUrl=ar;n.encodeURIComponentForWindowsProtocol=vr;n.setBingUrlLanguageAndRegion=yr;n.setUrlLang=ct;n.setUrlCC=lt;n.setUrlParameter=o}(WSB||(WSB={})),function(n){let i;(function(n){function t(t,i,r,u,f,e){let o={T:n.QFPERFPING_EVENT_NAME,ST:r,CVID:u,OFFSETS:i,STATE:f,V:n.QFPERFPING_VERSION,RFC:e};return{ImpressionGuid:t,EventType:n.CLIENTINST_EVENT_TYPE,Data:o}}n.CLIENTINST_EVENT_TYPE="ClientInst";n.QFPERFPING_EVENT_NAME="QFPerfPing";n.CLICK_EVENT_TYPE="Click";n.QFPERFPING_VERSION="2";n.QFPERFPING_INVALID_MEASURE=-2;n.INVALID_SEQUENCE_NUMBER=-2;n.KVALUE_SUGGESTIONS_START=1e3;n.KVALUE_SUFFIX_START=1;n.KVALUE_NON_SUGGESTIONS_START=100;n.KVALUE_DSB_MSB_CONTENT=2e3;n.KVALUE_MSB_DSB_SWITCH=4e4;n.KVALUE_DSB_CURRENT_DAY_CONTENT=5e4;n.KVALUE_DSB_PAST_DAYS_CONTENT=6e4;n.KVALUE_DSB_IFRAME_CONTENT=7e4;n.KVALUE_DSB_V2_CONTENT=8e4;n.KVALUE_DSB_MERGED_CONTENT=9e4;n.DEFAULT_APP_NAMESPACE="SmartSearch";n.DEFAULT_SERVICE_NAME="AutoSuggest";n.KVALUE_HIDDEN=1e5;n.DEFAULT_USER_ENGAGEMENT_CONTENT={engagementType:"",engagementSurface:""};n.createPerfPingEvent=t})(i=n.InstrumentationCommon||(n.InstrumentationCommon={}));class t{constructor(n,t,r,u){this._kValue=n;this._qsCode=t;this._handOffType=r;this._workflow=u;this._properties={};this._userEngagementContent=i.DEFAULT_USER_ENGAGEMENT_CONTENT}static createInstrumentedItem(i,r){let u;return n.config.splitWindowsDataInstrumentation?(u=new t(t.generateKValue(i,r),r),n.InstrumentationHelper.updateItemDataTypeProps(u,r)):u=new t(t.generateKValue(i),r),u}static createInstrumentedItemHandOffOverride(i,r,u){let f;return n.config.splitWindowsDataInstrumentation?(f=new t(t.generateKValue(i,r),r,u),n.InstrumentationHelper.updateItemDataTypeProps(f,r)):f=new t(t.generateKValue(i),r,u),f}static createInstrumentedItemHandOffOverrideAndQS(i,r,u,f){let e;return n.config.splitWindowsDataInstrumentation?(e=new t(t.generateKValue(i,r),r,u),n.InstrumentationHelper.updateItemDataTypeProps(e,r)):e=new t(t.generateKValue(i),r,u),e.setProperty(f,r),e}static createInstrumentedItemKvalueOverride(i,r,u,f){let e=new t(i,r,u,f);return n.config.splitWindowsDataInstrumentation&&n.InstrumentationHelper.updateItemDataTypeProps(e,r),e}static createInstrumentedItemForReformulation(i,r){let u;return n.config.splitWindowsDataInstrumentation?(u=new t(t.generateKValue(i,r),r,998),n.InstrumentationHelper.updateItemDataTypeProps(u,r)):u=new t(t.generateKValue(i),r,998),u}static createInstrumentedItemNoHandOff(i,r){let u;return n.config.splitWindowsDataInstrumentation?(u=new t(t.generateKValue(i,r),r,999),n.InstrumentationHelper.updateItemDataTypeProps(u,r)):u=new t(t.generateKValue(i),r,999),u}static getNonSuggestionInstrumentedItem(i,r,u){if(!r[i])throw new Error(`${i} not found in kvalues map`);let f=new t(r[i],i,u);return n.config.splitWindowsDataInstrumentation&&n.InstrumentationHelper.updateItemDataTypeProps(f,i),f}getKValue(){return this._kValue}getAppNS(){return t.AppNS}getLayoutKValue(){return this._kValue+"."+t.Suffix}getHValue(){return(n.config.pruneImpression||n.config.splitImpression)&&this._kValue>=i.KVALUE_HIDDEN?"ID=Hidden_"+t.AppNS+","+this.getLayoutKValue():"ID="+t.AppNS+","+this.getLayoutKValue()}getHandoffType(){return this._handOffType}getQsCode(){return this._qsCode}getWorkflow(){return this._workflow}setProperty(n,t){this._properties[n]=t}getProperties(){return Object.keys(this._properties).length>0?this._properties:undefined}static resetKValues(n){delete this._keystrokesKValues[n]}static generateKValue(t,r){let f=t,u=this._keystrokesKValues[f];return(u>0||(u=i.KVALUE_SUGGESTIONS_START),this._keystrokesKValues[f]=++u,(n.config.pruneImpression||n.config.splitImpression)&&!!r&&n.isWindowsData(r))?u+i.KVALUE_HIDDEN:u}setUserEngagementContent(n){this._userEngagementContent=n}getUserEngagementContent(){return this._userEngagementContent}}t.AppNS=i.DEFAULT_APP_NAMESPACE;t.Suffix=i.KVALUE_SUFFIX_START;t._keystrokesKValues={};n.InstrumentedItem=t}(WSB||(WSB={})),function(n){function ti(){return matchMedia("screen and (-ms-high-contrast)").matches}function a(){return(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.isOffline)?!1:navigator.onLine}function v(n){return n?n.replace(kt,"$1").replace(dt,"$1 "):n}function ii(n){return n?n.replace(/[-{}]/g,"").toLowerCase():null}function ri(n){return!n||Object.keys(n).length===0}function ui(n){return n.canFail}function y(n,t,i,r){n&&(n=n.slice(0,t)+o+n.slice(t,n.length));let u=i(n);if(u){let n=u.indexOf(o);t=n!=-1?n:t;u=u.replace(o,"")}r(u,t)}function fi(t){if(!t)return n.LogWSBError("getInputType",null,new Error("event object is missing"),undefined,undefined,"WindowsTelemetry"),0;switch(t.pointerType){case"mouse":return 2;case"touch":return 3;case"pen":return 4;default:return 1}}function s(n,...t){t.forEach(t=>delete n.enabledDataSources[t])}function ei(n){return n?n.toLowerCase()!="cn"&&n.toLowerCase()!="ru":!1}function p(i,r){if(!i||!r)return!1;var u=!n.config.bingFetchEnabledRegions||n.config.bingFetchEnabledRegions.length==0||t(n.config.bingFetchEnabledRegions,i.toLowerCase()),f=r.split("-")[0],e=!n.config.bingFetchEnabledLang||n.config.bingFetchEnabledLang.length==0||t(n.config.bingFetchEnabledLang,f.toLowerCase());return u&&e}function oi(i,r){if(!i||!r)return!1;var u=!n.config.miniSerpEnabledRegions||n.config.miniSerpEnabledRegions.length==0||t(n.config.miniSerpEnabledRegions,i.toLowerCase()),f=r.split("-")[0],e=!n.config.miniSerpEnabledLang||n.config.miniSerpEnabledLang.length==0||t(n.config.miniSerpEnabledLang,f.toLowerCase());return u&&e}function si(t,i){const r=`${i}:${t}`;return r===w?st():(w=r,n.isMarketEligible(t,i,n.config.trendingSearchInSHEligibleLangRegionPairs))}function hi(t,i){if(!t||!i)return!1;const r=`${i}:${t}`;return r===b?l:(b=r,n.isMarketEligible(t,i,n.config.DSBFullWidthMarkets))}function ci(t,i){if(!t||!i)return!1;const r=`${i}:${t}`;return r===k?ht():(k=r,n.isMarketEligible(t,i,n.config.thumbnailForTSEligibleLangRegionPairs))}function li(t,i,r){let u=t.queryToFetch&&t.queryToFetch.length<n.config.minQueryLengthForWebProvider||!p(i,r);return u&&s(t,"Web"),u}function ai(t){t.queryToFetch&&t.queryToFetch.length<n.config.coPiffTriggerKeystrokeThreshold&&(s(t,"CoPIFF"),s(t,"CoPCFP"))}function d(t){if(t){t=n.normalizeUrl(t,15);for(let n=1;n<t.length-1;++n)if(ni.includes(t[n]))return!0}return!1}function vi(t,i,r){let u,f;return r||(r=0),y(t,i,n=>v(n),(n,t)=>{u=n,f=t}),u&&(n.config&&n.config.doNotRemoveSpaceAfterIn&&u.toLocaleLowerCase().endsWith(" in ")||(u=u.trim()),f=Math.min(f,u.length)),{originalQuery:t,originalCursorPosition:i,queryToFetch:u,cursorPosition:f,enabledDataSources:{},equals:n=>(u?u.toLowerCase():u)==(n.queryToFetch?n.queryToFetch.toLowerCase():n.queryToFetch)&&r==n.topHitRestriction,isMultiWord:d(u),getCacheKey:()=>u,topHitRestriction:r}}function g(i,r){return r&&!r.enabledDataSources[i]?!1:t(n.config.enabledDataSources,i)}function nt(i,r,u,f){let e=f.enabledDataSources[i];return e?e.suggestionIsEnabled&&!e.suggestionIsEnabled(r,u)?!1:t(n.config.enabledDataSources,i):!1}function t(n,t){return n.indexOf(t)!=-1}function yi(n,t){let i=n.indexOf(t);return i!=-1?(n.splice(i,1),!0):!1}function pi(n,t){let i=n.findIndex(t);return i!=-1?n.splice(i,1)[0]:null}function wi(n,t,i){if(t<100)for(let r=n.length-1;n.length>t&&r>=0;--r)i(n[r])&&n.splice(r,1)}function bi(n,i){return n.filter(n=>!t(i,n))}function ki(n,t){if(n.length!=t.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!=t[i])return!1;return!0}function di(n,t){if(n===t)return!0;if(!n||!t||Object.keys(n).length!=Object.keys(t).length)return!1;for(let i in n)if(n[i]!=t[i])return!1;return!0}function tt(){return n.getCurrentDate().getTime()}function it(){return n.getCurrentDate().getHours()}function gi(){if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.dsbMockCurrentSec)return n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.dsbMockCurrentSec;let t=n.getCurrentDate();return t.getHours()*3600+t.getMinutes()*60+t.getSeconds()}function nr(){const n=it();return n<5||n>=19?3:n>=11?2:1}function e(n){let t=Math.abs(Math.floor(n));return(t<10?"0":"")+t}function tr(){let t=n.getCurrentDate(),i=-t.getTimezoneOffset(),r=i>=0?"+":"-";return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+"T"+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+e(t.getMilliseconds())+r+e(i/60)+":"+e(i%60)}function ir(n,t){return n?n.replace(gt,(n,i)=>t[i]):n}function rr(n){let t=n?n.number:null,i=n?n.name:null;return t==-2147023673||i=="Canceled"}function r(t,i,r,u,f,e){try{return t()}catch(o){return e||n.LogWSBError(i,u,o,undefined,undefined,"WindowsTelemetry"),f&&f(o),r}}function h(n,t,i,u,f,e){return sb_st(()=>r(n,i,null,u,f,e),t)}function ur(n,...t){r(()=>sj_evt.fire(n,...t),n)}function fr(n,t){h(t,1,n)}function c(n,t){let i=[],r=!0,u=(...n)=>{r?i.push(n):t.apply(null,n)};n(u);r=!1;i.forEach(n=>t.apply(null,n))}function er(t,i,r){u=t&&vt()!="ms-appx-web:"&&yt()!="searchapp.bundleassets.example";n.config.enableOfflineWithWeb&&n.config.webHost&&a()&&(u=t);rt=u&&p(i,r);ut=u&&oi(i,r);ft=u&&si(i,r);l=u&&hi(i,r);et=u&&ci(i,r);ot=u&&ei(i)}function or(){const t=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return(n.Host===null||n.Host===void 0?void 0:n.Host.isFirstPartySearchDisabled())&&t!=1?!1:u}function sr(){return rt}function hr(){return ut}function st(){return ft}function cr(){return l}function ht(){return et}function lr(){const t=n.AccessTokenManager.getWindowsAccountType();return!!n.config.isCodexEligible&&ot&&!n.config.wsbWithCopilotQF&&!n.isThirdPartySearchAllowed()&&(t==2&&n.Host.getIsCodexUser()||t==3||n.isMsbInternalTenant()&&n.config.msbEnableCodexBtnUpperRightMs)}function pr(n){return t(ar,n)}function wr(n){return t(at,n)}function br(n){return t(vr,n)}function kr(n){return n==37}function dr(n){return t(ct,n)}function gr(n){return t(lt,n)}function nu(n){return t(yr,n)}function tu(n,t){return n==121&&t||n==93}function iu(n,t){return n==8||n==46||n==88&&t.ctrlKey}function vt(){return _w.location.protocol}function yt(){return _w.location.host}function ru(){return _w.location.pathname}function uu(){let n=_d.activeElement;return!n||n.id.endsWith("sb_form_q")?_d.body:n}function pt(t){return t&&+t!=n.WindowsApiDefaultDate&&t.getTime&&!isNaN(t.getTime())&&t.getFullYear()!=1600}function wt(t){if(!pt(t))return null;let i=t.getTime(),r=tt();return Math.abs(r-i)/n.DayToMs}function fu(n){let t=wt(n);return t!==null&&t>14}function eu(n){return n==="i"?13:n==="v"?14:0}function ou(){const t=n.Host.getIFFPolarisProviderEnabled()||n.Host.getVegaProviderEnabled(),i=(n.VelocityKeys===null||n.VelocityKeys===void 0?void 0:n.VelocityKeys.isFeatureEnabled(56039577))||(n.VelocityKeys===null||n.VelocityKeys===void 0?void 0:n.VelocityKeys.isFeatureEnabled(56154553))||(n.VelocityKeys===null||n.VelocityKeys===void 0?void 0:n.VelocityKeys.isFeatureEnabled(56384656)),r=n.config.updateSemanticSearchTelemetry;return t&&r&&i}function hu(n){return encodeURIComponent(n).replace(/[!'()*]/g,escape).replace(/%20/g,"+")}const o=String.fromCharCode(57346),kt=new RegExp("^\\s*("+o+")?\\s*"),dt=new RegExp("\\s*("+o+")?\\s+","g"),gt=/{([0-9]+)}/g,ni=" -_/\\";n.DayToMs=864e5;n.HourToMs=36e5;n.MinuteToMs=6e4;n.DebugSourceName="WindowsSearchBox";SharedLogHelper.RegisterErrorFilter(t=>{let i=t?t.number:null,r=t?t.name:null;return i===-2147023673||i===-2147215328||i===-2147215865&&(n.AnaheimDataProvider===null||n.AnaheimDataProvider===void 0?void 0:n.AnaheimDataProvider.getRetryCount())>0||r==="Canceled"});n.isHighContrastEnabled=ti;n.isBrowserOnline=a;n.cleanQuery=v;n.cleanGuid=ii;n.isEmpty=ri;n.canIconFail=ui;n.mantainCursorPositionIn=y;n.getInputType=fi;n.disableDataSources=s;let w="",b="",k="";n.disableWebDataSourceIfNeeded=li;n.disableCoPiffDataSourcesOnConditions=ai;n.isMultiWord=d;n.baseParseQuery=vi;n.isDataSourceEnabled=g;n.isSuggestionTypeEnabled=nt;n.contains=t;n.tryRemove=yi;n.removeFirstWhere=pi;n.trimList=wi;n.except=bi;n.sequenceEqual=ki;n.objEquals=di;n.log=()=>{};n.getCurrentDate=()=>new Date;n.getCurrentTime=tt;n.getCurrentHour=it;n.getCurrentTimeInSeconds=gi;n.getCopilotTimeOfDay=nr;n.getDateWithTimezone=tr;n.fetchWrapper=(n,t,i)=>i();n.formatString=ir;n.isCancellation=rr;n.safeExecute=r;n.safeSetTimeout=h;n.safeFireEvent=ur;n.invokeAsynchronously=fr;n.ensureCallbackIsAsync=c;let u=!0,rt=!0,ut=!0,ft=!0,l=!0,et=!0,ot=!0;n.refreshBingEnabledCache=er;n.isBingEnabled=or;n.isWebProviderEnabled=sr;n.isMiniSerpEnabled=hr;n.isTrendingSearchEnabled=st;n.isDSBV2EnabledMarket=cr;n.isThumbnailForTSEnabled=ht;n.isCodexEligible=lr;const ar=[3,16,17,18,19,20,144,145,],ct=[38,203,211,],vr=[39,37],lt=[40,204,212,],at=ct.concat(lt),yr=at.concat(37,39,36,35);n.isFunctionalKey=pr;n.isUpOrDownKey=wr;n.isLeftOrRightKey=br;n.isLeftKey=kr;n.isUpKey=dr;n.isDownKey=gr;n.isMovingCursorKey=nu;n.isContextMenuKey=tu;n.isDeletionKey=iu;n.getWindowProtocol=vt;n.getWindowHost=yt;n.getWindowPath=ru;n.getCurrentActiveElement=uu;n.WindowsApiDefaultDate=-116444736e5;n.isValidDate=pt;n.getTimeDiffInDays=wt;n.olderThan2Weeks=fu;n.verticalToHandoffType=eu;n.isSemanticSearchTelemetryEnabled=ou;class bt{constructor(){this._cancellations={};this._lastId=0}register(n,t,i){let r=++this._lastId;return this._cancellations[r]={action:n,skipOnDismissAndLaunch:t,where:i},r}unregister(n){delete this._cancellations[n]}cancelAll(n){for(let t in this._cancellations){let i=this._cancellations[t];i.skipOnDismissAndLaunch&&n||r(()=>i.action(),i.where)}this._cancellations={}}}n.CancellationManager=bt;class i{static logError(t,r){var u,f,e,o;if(i.errorCount=i.errorCount+1,n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.lightweightStorageFail){if(i.testHookErrorLogged)return;i.testHookErrorLogged=!0}if((n.LogWSBError("localStorage",t,new Error(r),undefined,undefined,"WindowsTelemetry"),!(i.errorCount>=5))&&(n.logToMC("Bing_QF_LocalStorage",r,"logError",{Msg:(t===null||t===void 0?void 0:t.message)?t.message:"",Stack:(t===null||t===void 0?void 0:t.stack)?t.stack:""}),n.config.enableLocalStorageFailureReport)){let h=typeof sj_cook!="undefined"?sj_cook===null||sj_cook===void 0?void 0:sj_cook.get("MUID","MUID"):(f=(u=_G===null||_G===void 0?void 0:_G.CID)!==null&&u!==void 0?u:_G===null||_G===void 0?void 0:_G.nclid)!==null&&f!==void 0?f:"";const s=n.InstrumentationHelper===null||n.InstrumentationHelper===void 0?void 0:n.InstrumentationHelper.createCleanGuid();if(!h||!s)return;try{if((n.config===null||n.config===void 0?void 0:n.config.disableWSBServerTelemetry)&&(n.VelocityKeys===null||n.VelocityKeys===void 0?void 0:n.VelocityKeys.isFeatureEnabled(40979072))&&((o=(e=SearchAppWrapper===null||SearchAppWrapper===void 0?void 0:SearchAppWrapper.CortanaApp)===null||e===void 0?void 0:e.regionalPolicies)===null||o===void 0?void 0:o.isThirdPartyWebSearchSupported))return}catch(it){}const i=(new Date).getTime(),l={T:"CI.Error",TS:i,Name:"JSError",Text:"[localStorage]"+r,Stack:(t===null||t===void 0?void 0:t.stack)?t.stack:"[localStorage]"+r},c=window.location,a=n.InstrumentationHelper===null||n.InstrumentationHelper===void 0?void 0:n.InstrumentationHelper.createCleanGuid(),v=c.protocol+"//"+c.host+"/QF_KEYSTROKE_VIRTUAL_URL?cvid="+a,y=typeof _G=="object"?_G:{},p=navigator.userAgent,w={CurUrl:window.location.href,Pivot:"QF",IsNonSuggestion:!0,EnrichedClientInfo:{FDPartnerEntry:"autosuggest",ImpressionUrl:v,qfMode:n.RuntimeConfig?`${n.RuntimeConfig.QfMode}`:undefined,DC:y.DA||undefined,isWebView2:p.includes("IsWebView2/True")?1:undefined},TS:i,UTS:i,UxClassification:{client:"windows"}},b=`<CID>${h}</CID>`,k=`<DS><![CDATA[[{"T":"D.Aggregator","Service":"AutoSuggest","Scenario":"Aggregator","AppNS":"SmartSearch","DS":[]}]]]></DS>`,d=`<E><T>Event.ClientInst</T><IG>${s}</IG><D><![CDATA[${JSON.stringify(l)}]]></D><TS>${i}</TS></E>`,g=`<Ovr><requestInfo key="RawQuery" value=""/><requestInfo key="IsQuery" value="false"/><requestInfo key="Form" value=""/><userInfo key="AppName" value="SmartSearch"/></Ovr>`,nt=`<M><IG>${s}</IG>${k}<D><![CDATA[${JSON.stringify(w)}]]></D><Page><Name>Page.SmartSearch.AS.Suggestions</Name>${"<L><![CDATA[[]]\]><\/L>"}</Page><TS>${i}</TS>${g}</M>`,tt=`<ClientInstRequest>${b}<Group>${nt}</Group><Events>${d}</Events></ClientInstRequest>`;fetch("/threshold/xls.aspx",{body:tt,method:"POST",headers:{"Content-Type":"text/xml"}})}}static getItem(t){var r;try{if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.lightweightStorageFail)throw new Error("TestHook: lightweightStorageFail");return((r=_w.localStorage)===null||r===void 0?void 0:r.getItem(t))||null}catch(u){return i.logError(u,"getItem"),null}}static setItem(t,r){var u;try{if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.lightweightStorageFail)throw new Error("TestHook: lightweightStorageFail");(u=_w.localStorage)===null||u===void 0?void 0:u.setItem(t,r)}catch(f){i.logError(f,"setItem")}}static removeItem(t){var r;try{if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.lightweightStorageFail)throw new Error("TestHook: lightweightStorageFail");return(r=_w.localStorage)===null||r===void 0?void 0:r.removeItem(t)}catch(u){i.logError(u,"removeItem")}}static removeItemsWithKeyPrefix(t){try{if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.lightweightStorageFail)throw new Error("TestHook: lightweightStorageFail");if(!_w.localStorage)return;const i=[];for(let n=0;n<_w.localStorage.length;n++){const r=_w.localStorage.key(n);(r===null||r===void 0?void 0:r.startsWith(t))&&i.push(r)}for(let n=0;n<i.length;n++)_w.localStorage.removeItem(i[n])}catch(r){i.logError(r,"removeItemsWithKeyPrefix")}}static clear(){var t;try{if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.lightweightStorageFail)throw new Error("TestHook: lightweightStorageFail");return(t=_w.localStorage)===null||t===void 0?void 0:t.clear()}catch(r){i.logError(r,"clear")}}static getLength(){var t;try{if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.lightweightStorageFail)throw new Error("TestHook: lightweightStorageFail");return((t=_w.localStorage)===null||t===void 0?void 0:t.length)||0}catch(r){return i.logError(r,"length"),0}}static key(t){var r;try{if(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.lightweightStorageFail)throw new Error("TestHook: lightweightStorageFail");return((r=_w.localStorage)===null||r===void 0?void 0:r.key(t))||null}catch(u){return i.logError(u,"key"),null}}}i.errorCount=0;n.LightweightStorage=i;class f{static resetSequenceNumber(){this._sequenceNumber=0}static getSequenceNumber(){return this._sequenceNumber}static incrementSequenceNumber(){this._sequenceNumber++}}f._sequenceNumber=0;n.SequenceNumberManager=f;class su{constructor(t,i,r,u,f){this._suggestionsParsers=t;this._rootViewModel=i;this._suggestionsRenderingManager=r;this._webProviders=u;this._otherProviders=f;this._cancellationManager=new bt;n.Host.bindShown(()=>{this._lastQuery=null,this._currentQuery=null,this._isPaneDismissed=!1});n.Host.bindDismissed(()=>{this.clearFetchTimer(),this.finishPreviousQuery(!0),this.finalizeKeystroke(!0),this._isPaneDismissed=!0,n.config&&n.config.dismissForceFlush&&Log2&&Log2.ForceFlush(),this._rootViewModel.onDismiss()});n.Host.bindQueryChangedOrInitialized((t,i)=>this.onQueryChanged(t,n.config.d,i),undefined,n.config.enableCoreQueryChangeFirst);n.Host.bindOnSubmit((n,t,i)=>this.onSubmit(n,t,i));n.Host.initializeEvents();sj_be(_d.body,"dragstart",t=>{if(!n.isSearchDragAndDropEnabled()){t.preventDefault();t.stopPropagation();return}});sj_b.addEventListener("click",n=>{n.shiftKey&&sj_pd(n)})}clearFetchTimer(){this._fetchTimer&&(sb_ct(this._fetchTimer),this._fetchTimer=null)}finishPreviousQuery(n){this.cancelPreviousQuery(n);this._suggestionsRenderingManager.resetTimers()}finalizeKeystroke(t){let i=f.getSequenceNumber();i>0&&n.InstrumentationHelper.finalizeKeystrokeLog(i);t||f.incrementSequenceNumber()}onQueryChanged(t,i,u){if(this._currentQuery=t,!u&&this._lastQuery&&this._lastQuery.equals(this._currentQuery))this._rootViewModel.onQueryChanged(this._currentQuery,f.getSequenceNumber());else this.clearFetchTimer(),this._completedDataSources={},(this._lastQuery||u)&&this.cancelPreviousQuery(!1),n.config.optimizeGetQueryLogic&&n.Host.getQuery(!0),this.logQueryChange(u,!1),i<=0||this._currentQuery.isSearchHomeZI||this._currentQuery.isThirdPartyZI?(this.fetchForQueryChange(u),r(()=>this.logVariantEventSearchHome(),"logVariantEventSearchHome",null,null,null,!0)):this._fetchTimer=h(()=>{this._fetchTimer=null,this.fetchForQueryChange(u)},i,"fetchTimer"),this._lastQuery=this._currentQuery}logQueryChange(t,i){let r=t?this._currentQuery:n.Host.getQuery();if(r.equals(this._currentQuery)){(this._lastQuery||t)&&this.finishPreviousQuery(i);this.finalizeKeystroke(!1);let r=f.getSequenceNumber();n.InstrumentationHelper.instrumentQueryChangedRequest(r,this._currentQuery)}}onSubmit(t,i,r){this._fetchTimer&&(this._currentQuery||(this._currentQuery=n.Host.getQuery(!0)),this.logQueryChange(!1,!0),this.fetchForQueryChange(!1));this._rootViewModel.submit(t,i,f.getSequenceNumber(),r,this._isPaneDismissed)}cancelPreviousQuery(n){this._cancellationManager&&this._cancellationManager.cancelAll(n)}fetchForQueryChange(t){this.clearFetchTimer();let i=t?this._currentQuery:n.Host.getQuery();if(i.equals(this._currentQuery)){let t=f.getSequenceNumber(),r=!n.config.enabledDataSources.some(n=>g(n,this._currentQuery));if(r)this._rootViewModel.onQueryChanged(this._currentQuery,t);let u=!1;if(this._suggestionsRenderingManager.initiateSequenceNumber(t,this._currentQuery,()=>u=!0),!r){let r=()=>!this._isPaneDismissed&&(n.config.d>0?i.equals(this._currentQuery):t==f.getSequenceNumber())&&!u,e=(new Date).getTime(),o=(n,u,f,o,s,h)=>this.onResponseReceived(i,t,n,u,f,r,o,s,e,h),s=u=>{n.InstrumentationHelper.instrumentFetchesBegin(t);n.config.enabledDataSources.forEach(t=>{n!==undefined&&n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().beginMark(t+".Fetch")});n.fetchWrapper(i,r,()=>{if(!n.isSupportWebResultsInAllScopeInDMAEnabled()&&n.isThirdPartySearchAllowed()&&i.scope==n.Scope.ThirdPartyWeb){this.fetchTPWeb(i,t,u,r);return}this._webProviders.forEach(n=>{this.fetchWeb(i,n,t,u,r)});this._otherProviders.forEach(n=>{this.fetch(i,n,t,u,r)})});n.InstrumentationHelper.instrumentFetchesEnd(t);this._rootViewModel.onQueryChanged(this._currentQuery,t)};c(s,o)}}}fetchTPWeb(t,i,u,f){var e;if(n.isThirdPartySearchAllowed()&&((e=t.thirdPartySearch)===null||e===void 0?void 0:e.applicationUserModelId)){let o=n.Host.initUrlParameters(),e=n.Host.getThirdPartyDataProviderById(t.thirdPartySearch.applicationUserModelId);r(()=>e.fetch(t,u,i,this._cancellationManager,f,o),"fetch "+e.getName())}}fetchWeb(t,i,u,f,e){const s=n.Service.QueryParams;let o=n.Host.getCustomUrlParameters(t);n.Host.shouldRequestEltoken()&&(o[s.RequestElToken]="1");(!n.RuntimeConfiguration.DeviceHistoryEnabled||n.isThirdPartySearchAllowed()||n.config.isDMARegion)&&(o[s.SearchHistorySettingOff]="1");o[s.CursorPosition]=t.cursorPosition.toString();o[s.ConversationId]=n.Host.getConversationId();o[s.ImpressionGuid]=n.InstrumentationHelper.getImpressionGuid(u);let h=n.Host.getCustomHeaders(t);r(()=>i.fetch(t,f,u,this._cancellationManager,e,o,h),"fetch "+i.getName())}fetch(n,t,i,u,f){r(()=>t.fetch(n,u,i,this._cancellationManager,f),"fetch "+t.getName())}onResponseReceived(t,i,r,u,f,e,o,s,h,l){if(e()){if(this._completedDataSources[r]){n.config.forceUseNifQF&&r=="Web"||n.LogWSBError("onResponseReceived",r,new Error(`Data source already completed: ${r}`),undefined,undefined,"WindowsTelemetry");return}n!==undefined&&n.config.perfLogging&&n.WSBPerformance&&n.WSBPerformance.getInstance().endMark(r+".Fetch");this._completedDataSources[r]=!l;n.InstrumentationHelper.instrumentResponseReceived(i,r,f,o,s,l);let h=(r,u,o)=>{if(n.InstrumentationHelper.instrumentDataSourceParsed(i,r),n.TweakDiagnostics===null||n.TweakDiagnostics===void 0?void 0:n.TweakDiagnostics.pushDiagnostics("onDataSourceParsed",[r,u]),e()){if(!n.isSupportWebResultsInAllScopeInDMAEnabled()&&n.isThirdPartySearchAllowed()&&t.scope==n.Scope.ThirdPartyWeb){this.onTPSuggestionsParsed(i,r,u);return}this.onSuggestionsParsed(t,i,r,f,u,o,l)}},a=f=>{let o=this._suggestionsParsers[r];o?o.parse(t,i,r,u,e,f,this._cancellationManager):(n.LogWSBError("onResponseReceived",r,new Error("No parser for data source"),undefined,undefined,"WindowsTelemetry"),f(r,[],null))};c(a,h)}}onTPSuggestionsParsed(t,i,u){r(()=>this._rootViewModel.update(!0,u.slice(0,1),!1,t,u.slice(1),[],[i],[{type:n.GroupType.SearchSuggestions}],!0,{}),"rootViewModel.update",0,null,t=>{n&&n.fallbackToPrepopulatedBundle&&n.fallbackToPrepopulatedBundle(t)})}onSuggestionsParsed(t,i,r,u,f,e,o){if(f=f.filter(n=>nt(r,n.type,n.handoffType,t)),n.InstrumentationHelper.instrumentDataSource(i,r,f,e),n.isWebXTFlightsTelemetry()){let o=e===null||e===void 0?void 0:e.responseHeader;if(o&&o.hasOwnProperty("X-FlightsTelemetry-Flight")){let t=o["X-FlightsTelemetry-Flight"];n.InstrumentationHelper.instrumentFlightAssignment(i,t)}this._rootViewModel.onSuggestionsParsed(t,i,r,u,f)}else this._rootViewModel.onSuggestionsParsed(t,i,r,u,f,e);this._suggestionsRenderingManager.queueSuggestions(i,r,f,e,o)}logVariantEventSearchHome(){const t=n.AccessTokenManager.getWindowsAccountType();if(this._currentQuery.isSearchHomeZI&&this._currentQuery.scope==n.Scope.All||this._currentQuery.isWorkScopeZI&&_w.bfbWsbTel&&(t===1||t===4)&&n.isMsbEnterprise()&&!(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.isGccHighTenant())){let t=n.shouldShowDSBLayout(this._currentQuery);bfbWsbTel.logVariantEvent(t)}}}n.Core=su;n.encodeQueryParameter=hu}(WSB||(WSB={})),function(n){function si(t){return n.contains(d,t)}function rt(t){return n.contains(g,t)}function hi(t){return n.contains(fi,t)}function ci(t){return n.contains(tt,t)}function v(t){return n.contains(it,t)}function f(t){return n.contains(ni,t)}function e(t){return n.contains(ti,t)}function li(n){return n==="CopSugg"}function y(t){return n.contains(ii,t)}function ai(t){return n.contains(ri,t)}function vi(t){return n.contains(ei,t)}function yi(t){return n.contains(ui,t)}function pi(n,t){return n===t||f(n)&&f(t)||v(n)&&v(t)}function wi(t){return n.contains(gt,t)}function bi(t){return n.contains(nt,t)}function ut(t){let i=t===null||t===void 0?void 0:t.extensionLC;return!!i&&n.contains([".png",".jpeg",".jpg",".svg",".text",".txt",".pdf",".docx",".json",".csv",".xlsx",".pptx",".md",],i)}function ki(n){return ut(n)||rt(n===null||n===void 0?void 0:n.type)||f(n===null||n===void 0?void 0:n.type)}function di(t){return t&&n.contains([".pptx",],t)}function gi(t){return!!t&&n.contains([".xlsx",],t)}function ft(){return n.isDataSourceEnabled("SSUE",null)}function et(t){var r=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();let i=!n.config.userProfileButtonEnabled||r==t;switch(t){case 2:return i&&n.isSubstrateOutlookAccountConnected;case 1:return i&&n.isSubstrateO365AccountConnected;case 4:return i&&n.isSubstrateO365AccountConnected&&n.isSubstrateOutlookAccountConnected;default:return!1}}function nr(t){let i=SearchAppWrapper.CortanaApp.authenticationManager.getAllSearchWebAccountsAsync;var r=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return i?!0:r==t}function tr(){return{dataSource:"ANA",groupType:t.SearchSuggestions,requirements:[1],conditionalRequirements:t=>n.isAnaheimDataEnabled(!1,t),suggestionIsEnabled:t=>t=="ANAH"||t=="ANAR"||t=="ANAF"||t=="ANAT"||n.config.topHitMuse&&t=="ANATH"}}function r(n,t,i,r){return h(n,undefined,t,i,r)}function h(t,i,r,u,f){return{dataSource:t,groupType:i,requirements:[1],conditionalRequirements:t=>(r==1?n.isCloudSearchEnabledAadCache:n.isCloudSearchEnabledMsaCache)&&(!f||f(t))&&(u||t&&t.queryToFetch&&t.queryToFetch.length>=n.config.minLengthFor3SonL1)&&nr(r)&&et(r)}}function ir(){return n.isDocSourceEnabledInQws("SREE")}function ot(){if(n.msbHost!==null&&n.msbHost!==void 0)return n.msbHost.qfUtils.isMsbQfInScriptsEarlyLoadState()}function l(t,r){return{dataSource:"MSBC",requirements:[1],conditionalRequirements:u=>{if(!n.msbHost||!n.isBingEnabled())return!1;const f=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType(),e=r===i.Documents&&n.msbHost.qfUtils.isMsbFileReady(),o=r===i.Web&&!n.msbHost.features.isWorkScopeApplicable(),s=!r||e||o;return n.isCloudSearchEnabledAadCache&&s&&(t||u&&u.queryToFetch&&u.queryToFetch.length>=oi)&&(f==1||f==4||n.config.msbMockToken||ot())&&(n.msbHost.isTenantMsbEnabled()||ot())&&!n.msbHost.isGccHighTenant()}}}function a(){var t=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return!n.isCloudSearchEnabledAadCache&&!n.isCloudSearchEnabledMsaCache||t==3||t==0||!ft()?!1:!et(t)}function st(){return n.isDocSourceEnabledInQws("SSUE")}function ht(){var t=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return t==2||t==4}function ct(t){return t.isSearchHomeZI&&(n.isDataSourceEnabled("SSUE",t)||n.isDataSourceEnabled("SREE",t))}function rr(n,t){return t.siteTitle&&n.isSearchHomeZI}function ur(){n.ScopeConfig[i.All].getEmptyZIMessages=()=>u(i.All,"EmptyAllMessage",n.isBingEnabled()?"EmptyAllSubMessage":"EmptyAllSubMessageNoWeb",at(!0));n.RuntimeConfig.SearchHomeAvailable==1?(n.ScopeConfig[i.All].icon=n.getSearchSuggestionIcon(),n.ScopeConfig[i.All].enabledDataSourcesForZeroInput=[{dataSource:"TOPP",groupType:t.TopApps,suggestionGroupToggler:c(t.TopApps),conditionalRequirements:t=>n.shouldShowZIDataSource(t)&&!n.canShowSearchHomeAIFeed(t)},{dataSource:"SMA",groupType:t.SmartActions,suggestionGroupToggler:c(t.SmartActions),conditionalRequirements:t=>n.canShowSearchHomeAIFeed(t)},{dataSource:"DFLS",groupType:t.CuratedSuggestions,suggestionGroupToggler:c(t.CuratedSuggestions),conditionalRequirements:t=>n.canShowCuratedSuggestions(t)},{dataSource:"CUSE",groupType:t.CuratedSettings,suggestionGroupToggler:c(t.CuratedSettings),conditionalRequirements:t=>n.canShowCuratedSettings(t)&&!n.canShowSearchHomeAIFeed(t)},{dataSource:"QSCH",groupType:t.QuickSearch,suggestionGroupToggler:c(t.QuickSearch),conditionalRequirements:t=>n.canShowQuickSearch(t)&&!n.canShowSearchHomeAIFeed(t)},{dataSource:"MSBC",groupType:t.QuickWorkSearch,conditionalRequirements:()=>n.canShowQuickWorkSearch()},{dataSource:"MRU",groupType:t.MRUHistory,conditionalRequirements:()=>n.enableMRUSearchHome()||n.config.enableMRUDSBV2&&n.shouldShowDSBFullWidth()},{dataSource:"MWS",groupType:t.MRUHistory,conditionalRequirements:t=>n.enableMRUSearchHome()&&n.canShowWorkSearchMru(t)},{dataSource:"MPP",groupType:t.MRUHistory,conditionalRequirements:()=>n.enableMRUSearchHome()},{dataSource:"MST",groupType:t.MRUHistory,conditionalRequirements:()=>n.enableMRUSearchHome()},{dataSource:"MFF",suggestionIsEnabled:()=>!0,groupType:t.MRUHistory,conditionalRequirements:()=>n.enableMRUSearchHome()},{dataSource:"MRS",groupType:t.MRUHistory,requirements:[1,2],conditionalRequirements:()=>n.enableMRUSearchHome()||n.config.enableMRUDSBV2&&n.shouldShowDSBFullWidth()},{dataSource:"ANA",groupType:t.AnaheimDataList,requirements:[1],conditionalRequirements:t=>n.config.enableWin11SSH?n.shouldShowStaticSearchHome(t)&&n.isAnaheimDataEnabled(!0,t):n.isAnaheimDataEnabled(!0,t),suggestionIsEnabled:n=>n=="QSSG"||n=="ANAT"||n=="ANAH"||n=="ANAR"},{dataSource:"TS",groupType:t.TrendingSearchData,conditionalRequirements:t=>n.isTrendingSearchDataEnabled(t)||n.isTrendingSearchDataInWin11LeftPaneEnabled(t),suggestionIsEnabled:n=>n=="TS"},{dataSource:"RWQ",groupType:t.MRUHistory,conditionalRequirements:t=>n.isRecentWorkSearchEnabled(t)},h("SSUE",t.RecommendedDocs,1,!0,()=>st()),h("SREE",t.RecommendedDocs,1,!0,()=>ir()),{dataSource:"Web",groupType:t.SearchSuggestions,requirements:[1,2],conditionalRequirements:()=>n.isASWebEnabledOnSearchHome()},{dataSource:"QWQS",groupType:t.MsbQuickWorkQueriesTopList,conditionalRequirements:t=>(t===null||t===void 0?void 0:t.isSearchHomeZI)&&t.scope===i.All&&n.msbHost&&n.msbHost.features.isQwsEnabled()&&n.msbHost.isEduTenant()&&n.config.msbDsbEnabled},{dataSource:"AIF",groupType:t.AIFeed,conditionalRequirements:t=>n.canShowSearchHomeAIFeed(t)},],n.canShowAnaheimWin11ZITopSites()?(n.shouldShowStaticSearchHome(n.Host.getQuery(!0))&&(n.ScopeConfig[i.All].staticGroupOrderForZeroInput=()=>[t.Upsell,n.config.wsbWithCopilot?null:t.MRUHistory,n.config.wsbWithCopilot?null:t.CuratedSuggestions,t.AnaheimDataTile,t.CuratedSettings,t.TopApps,t.AnaheimDataList,t.QuickWorkSearchTopList,t.MsbQuickWorkQueriesTopList,t.QuickWorkSearch,t.RecommendedDocs,t.MsbOnRampButton,t.SmartActions,t.AIFeed,t.TrendingSearchData,t.QuickSearch,t.PromoBanner,n.config.wsbWithCopilot?t.MRUHistory:null,n.config.wsbWithCopilot?t.CuratedSuggestions:null]),n.canShowWorkScopeZiPageContent(n.Host.getQuery(),!0)&&(n.ScopeConfig[i.Work].staticGroupOrderForZeroInput=()=>[n.config.wsbWithCopilot?null:t.MRUHistory,n.config.wsbWithCopilot?null:t.CuratedSuggestions,t.CuratedSettings,t.TopApps,t.QuickWorkSearchTopList,t.MsbQuickWorkQueriesTopList,t.QuickWorkSearch,t.RecommendedDocs,t.MsbOnRampButton,t.SmartActions,t.AIFeed,t.TrendingSearchData,t.QuickSearch,n.config.wsbWithCopilot?t.MRUHistory:null,n.config.wsbWithCopilot?t.CuratedSuggestions:null])):n.shouldShowStaticSearchHome(n.Host.getQuery(!0))?(n.ScopeConfig[i.All].staticGroupOrderForZeroInput=()=>[t.Upsell,n.config.wsbWithCopilot?null:t.MRUHistory,n.config.wsbWithCopilot?null:t.CuratedSuggestions,t.CuratedSettings,t.AnaheimDataTile,t.TopApps,t.AnaheimDataList,t.QuickWorkSearchTopList,t.MsbQuickWorkQueriesTopList,t.QuickWorkSearch,t.RecommendedDocs,t.MsbOnRampButton,t.SmartActions,t.AIFeed,t.TrendingSearchData,t.QuickSearch,t.PromoBanner,n.config.wsbWithCopilot?t.MRUHistory:null,n.config.wsbWithCopilot?t.CuratedSuggestions:null],n.canShowWorkScopeZiPageContent(n.Host.getQuery(),!0)&&(n.ScopeConfig[i.Work].staticGroupOrderForZeroInput=()=>[n.config.wsbWithCopilot?null:t.MRUHistory,n.config.wsbWithCopilot?null:t.CuratedSuggestions,t.CuratedSettings,t.TopApps,t.QuickWorkSearchTopList,t.MsbQuickWorkQueriesTopList,t.QuickWorkSearch,t.RecommendedDocs,t.MsbOnRampButton,t.SmartActions,t.AIFeed,t.TrendingSearchData,t.QuickSearch,n.config.wsbWithCopilot?t.MRUHistory:null,n.config.wsbWithCopilot?t.CuratedSuggestions:null])):n.shouldShowDSBLayout(n.Host.getQuery())?(n.ScopeConfig[i.All].staticGroupOrderForZeroInput=()=>[t.Upsell,n.config.wsbWithCopilot?null:t.MRUHistory,n.config.wsbWithCopilot?null:t.CuratedSuggestions,t.AnaheimDataTile,t.TopApps,t.AnaheimDataList,t.QuickWorkSearchTopList,t.MsbQuickWorkQueriesTopList,t.QuickWorkSearch,t.RecommendedDocs,t.MsbOnRampButton,t.SmartActions,t.AIFeed,t.TrendingSearchData,t.QuickSearch,t.PromoBanner,n.config.wsbWithCopilot?t.MRUHistory:null,n.config.wsbWithCopilot?t.CuratedSuggestions:null],n.canShowWorkScopeZiPageContent(n.Host.getQuery(),!0)&&(n.ScopeConfig[i.Work].staticGroupOrderForZeroInput=()=>[t.MRUHistory,t.CuratedSuggestions,t.QuickWorkSearchTopList,t.MsbQuickWorkQueriesTopList,t.QuickWorkSearch,t.RecommendedDocs,t.MsbOnRampButton,])):n.ScopeConfig[i.All].staticGroupOrderForZeroInput=n.shouldEnableAnaheimResetDefault()?()=>[t.Upsell,t.PromoBanner,t.AnaheimDataTile,t.TopApps,n.config.wsbWithCopilot?null:t.MRUHistory,t.AnaheimDataList,t.QuickWorkSearchTopList,t.MsbQuickWorkQueriesTopList,t.QuickWorkSearch,t.RecommendedDocs,t.MsbOnRampButton,t.SmartActions,t.AIFeed,t.TrendingSearchData,t.QuickSearch,t.VisualSearch,n.config.wsbWithCopilot?t.MRUHistory:null]:()=>[t.AnaheimDataTile,t.TopApps,n.config.wsbWithCopilot?null:t.MRUHistory,t.AnaheimDataList,t.QuickWorkSearchTopList,t.MsbQuickWorkQueriesTopList,t.QuickWorkSearch,t.RecommendedDocs,t.MsbOnRampButton,t.SmartActions,t.AIFeed,t.TrendingSearchData,t.QuickSearch,t.Upsell,t.PromoBanner,t.VisualSearch,n.config.wsbWithCopilot?t.MRUHistory:null]):n.ScopeConfig[i.All].enabledDataSourcesForZeroInput=[]}function lt(){n.ScopeConfig={};n.ScopeConfig[i.All_FileExplorer]={icon:null,prefixesLocString:null,enabledDataSources:[{dataSource:"FEH"},{dataSource:"IFF"},{dataSource:"MDOC",conditionalRequirements:()=>n.config.useL2ProvidersInFileExplorer},{dataSource:"MPHO",conditionalRequirements:()=>n.config.useL2ProvidersInFileExplorer},{dataSource:"MVID",conditionalRequirements:()=>n.config.useL2ProvidersInFileExplorer},{dataSource:"SSUE",requirements:[1,2],conditionalRequirements:()=>n.config.cloudSearchInFileExplorer&&(n.isFileExplorerCurrentPathThisPcOrQuickAccess||!!SearchAppWrapper.CortanaApp.fileExplorerSuggestionPage.currentSyncRootAccount)},{dataSource:"SSEE",requirements:[1,2],conditionalRequirements:()=>n.config.cloudSearchInFileExplorer&&(n.isFileExplorerCurrentPathThisPcOrQuickAccess||!!SearchAppWrapper.CortanaApp.fileExplorerSuggestionPage.currentSyncRootAccount)},],enabledDataSourcesForZeroInput:[{dataSource:"FEH"},],getEmptyZIMessages:null};n.ScopeConfig[i.All_SettingsApp]={icon:null,prefixesLocString:null,enabledDataSources:[{dataSource:"ST"},{dataSource:"MST"},{dataSource:"CoPST"},],enabledDataSourcesForZeroInput:[],getEmptyZIMessages:null};n.ScopeConfig[i.All_ControlPanel]={icon:{content:"&#xE713",type:2},prefixesLocString:"ScopeSettings",enabledDataSources:[{dataSource:"Web",suggestionIsEnabled:()=>!1,requirements:[1,2]},{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MST"},{dataSource:"ST"},{dataSource:"QS",requirements:[1,2]}],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MST"},],getEmptyZIMessages:null};n.ScopeConfig[i.All]={icon:{content:"&#xE782",type:n.config.undocked?8:2,needsAccentColor:!0},prefixesLocString:"ScopeAll",enabledDataSources:[{dataSource:"PP"},{dataSource:"ST"},{dataSource:"FL",conditionalRequirements:t=>{var i;return!n.config.providerConditionAggressive||((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"LM",conditionalRequirements:t=>{var i;return!n.config.providerConditionAggressive||((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"IFF",conditionalRequirements:t=>{var i;return!n.config.providerConditionAggressive||((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders+1}},{dataSource:"CG"},{dataSource:"MRU"},{dataSource:"MPP"},{dataSource:"MST"},{dataSource:"MFF",conditionalRequirements:t=>{var i;return!n.config.providerConditionAggressive||((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"MRS",groupType:t.MRUHistory,requirements:[1,2],conditionalRequirements:()=>n.config.enableMruProviderInQF&&(n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType())===3},{dataSource:"Web",requirements:[1,2],conditionalRequirements:t=>{var i;return((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"TPWeb",groupType:t.DMAWeb,requirements:[1,3],conditionalRequirements:t=>{var i;return((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"OSTMA",requirements:[1,2],conditionalRequirements:t=>{var i;return((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders+(n.config.providerConditionAggressive?1:0)}},{dataSource:"OSTMAN",requirements:[1,2],conditionalRequirements:t=>{var i;return((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders+(n.config.providerConditionAggressive?1:0)}},{dataSource:"QS",requirements:[1,2],conditionalRequirements:t=>{var i;return((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders+(n.config.providerConditionAggressive?1:0)}},{dataSource:"SAPP",conditionalRequirements:t=>{var i;return n.isStoreAppEnabled(t)&&((i=t===null||t===void 0?void 0:t.queryToFetch)===null||i===void 0?void 0:i.length)>n.config.minQueryLengthForAllScopeProviders}},{dataSource:"CoPIFF"},{dataSource:"CoPCFP"},{dataSource:"CoPST"},{dataSource:"SWMF",suggestionIsEnabled:n=>e(n),conditionalRequirements:()=>n.Host.getFindSharedFilesEnabled()&&(n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getAadAccountsCount())>0},{dataSource:"RSH",conditionalRequirements:t=>n.isRSHEnabled(t)},tr(),r("SSUE",1,!1,()=>!(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.qfUtils.is3sFileDisabled())),l(!1),],enabledDataSourcesForZeroInput:[],webSyntheticEnabled:t=>t.queryToFetch&&!n.isWebResultsDisabled(),getEmptyZIMessages:null,showUpsellOnSuggestionsList:n.config.accountVerificationInAllScope||n.config.msbAccountVerificationInSearchHome?()=>a():undefined};n.ScopeConfig[i.Apps]={icon:{content:n.config.useCobaltCSS?"&#xECAA":"&#xEB3B",type:2},prefixesLocString:"ScopeApps",enabledDataSources:[{dataSource:"Web",suggestionIsEnabled:t=>t=="SPP"&&!n.config.isDMARegion,requirements:[1,2]},{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MPP"},{dataSource:"PP",suggestionIsEnabled:n=>n=="PP"},{dataSource:"OSTMA",requirements:[1,2]},{dataSource:"OSTMAN",requirements:[1,2]},{dataSource:"IBA"},{dataSource:"SAPP",conditionalRequirements:t=>n.isStoreAppEnabled(t)},],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"TOPP",conditionalRequirements:n=>n.isSearchHomeZI},{dataSource:"MPP"},n.contains(n.config.enabledDataSources,"LRA")?{dataSource:"LRA"}:{dataSource:"PP",suggestionIsEnabled:n=>n=="PP"}],staticGroupOrderForZeroInput:n=>n.isSearchHomeZI?[t.TopApps,t.Apps]:undefined,getEmptyZIMessages:()=>u(i.Apps,"EmptyAppsMessage","EmptyAppsSubMessage","EmptyScopeSearchLocation_PC")};n.ScopeConfig[i.Settings]={icon:{content:"&#xE713",type:2},prefixesLocString:"ScopeSettings",enabledDataSources:[{dataSource:"Web",suggestionIsEnabled:()=>!1,requirements:[1,2]},{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MST"},{dataSource:"ST"},{dataSource:"QS",requirements:[1,2]},{dataSource:"CoPST"},],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MST"},],getEmptyZIMessages:()=>s(i.Settings,!1)};n.ScopeConfig[i.Photos]={icon:{content:"&#xEB9F",type:2},prefixesLocString:"ScopePhotos",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MFF",suggestionIsEnabled:n=>f(n)},{dataSource:"MPHO",suggestionIsEnabled:n=>n=="LI"},{dataSource:"CoPIFF",suggestionIsEnabled:()=>f("LI")},{dataSource:"CoPCFP",suggestionIsEnabled:()=>f("LI")},],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MFF",suggestionIsEnabled:n=>f(n)},],getEmptyZIMessages:()=>s(i.Photos,!0)};n.ScopeConfig[i.Videos]={icon:{content:"&#xE714",type:1},prefixesLocString:"ScopeVideos",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MFF",suggestionIsEnabled:n=>n=="LV"},{dataSource:"MVID",suggestionIsEnabled:n=>n=="LV"},],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MFF",suggestionIsEnabled:n=>n=="LV"},],getEmptyZIMessages:()=>s(i.Videos,!0)};n.ScopeConfig[i.Music]={icon:{content:n.config.useCobaltCSS?"&#xE90B":"&#xE8D6",type:2},prefixesLocString:"ScopeMusic",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MFF",suggestionIsEnabled:n=>n=="MU"},{dataSource:"MMUS",suggestionIsEnabled:n=>n=="MU"},],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MFF",suggestionIsEnabled:n=>n=="MU"},],getEmptyZIMessages:()=>s(i.Music,!1)};n.ScopeConfig[i.Documents]={icon:{content:n.config.useCobaltCSS?"&#xE8A5":"&#xE7C3",type:2},prefixesLocString:"ScopeDocuments",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MFF",suggestionIsEnabled:n=>e(n)},{dataSource:"MDOC",suggestionIsEnabled:n=>n=="FL"},{dataSource:"CoPIFF",suggestionIsEnabled:n=>e(n)},{dataSource:"CoPCFP",suggestionIsEnabled:n=>e(n)},{dataSource:"MPHO",suggestionIsEnabled:n=>n=="FL",conditionalRequirements:n=>!n||!n.taskFrame},{dataSource:"MVID",suggestionIsEnabled:n=>n=="FL",conditionalRequirements:n=>!n||!n.taskFrame},{dataSource:"MPVD",suggestionIsEnabled:n=>n=="FL",conditionalRequirements:t=>n.config.mergeQueries&&(!t||!t.taskFrame)},{dataSource:"PP",suggestionIsEnabled:n=>n=="LDOC"},{dataSource:"SWMF",suggestionIsEnabled:n=>e(n),conditionalRequirements:()=>n.Host.getFindSharedFilesEnabled()&&(n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getAadAccountsCount())>0},r("SSUE",1,!0,()=>!(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.qfUtils.is3sFileDisabled())),r("SSEE",1,!0,()=>!(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.qfUtils.is3sFileDisabled())),l(!0,i.Documents)],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MFF",suggestionIsEnabled:n=>e(n)},{dataSource:"IFF",suggestionIsEnabled:n=>e(n),conditionalRequirements:()=>n.config.enableZeroInputSearchHomeDocuments},h("SSUE",t.RecommendedDocs,1,!0,()=>sr()),h("SREE",t.RecommendedDocs,1,!0,()=>!1),],showUpsellOnSuggestionsList:()=>a(),getEmptyZIMessages:()=>s(i.Documents,!1)};n.ScopeConfig[i.Folders]={icon:{content:"&#xE8B7",type:2},prefixesLocString:"ScopeFolders",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MFF",suggestionIsEnabled:n=>n=="FD"},{dataSource:"MFOL",suggestionIsEnabled:n=>n=="FD"},{dataSource:"CoPIFF",suggestionIsEnabled:()=>y("FD")},{dataSource:"CoPCFP",suggestionIsEnabled:()=>y("FD")},],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:()=>!1},{dataSource:"MFF",suggestionIsEnabled:n=>n=="FD"},],getEmptyZIMessages:()=>s(i.Folders,!1)};n.ScopeConfig[i.Web]={icon:n.config.useCobaltCSS?{content:"&#xF6FA",type:2}:{content:"&#xE774",type:1},prefixesLocString:"ScopeWeb",enabledDataSources:[{dataSource:"MRU",suggestionIsEnabled:(t,i)=>i==1||n.config.enableMruProviderInQF&&i==0&&(n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType())===3},{dataSource:"MRS",suggestionIsEnabled:(n,t)=>t==0,conditionalRequirements:()=>n.config.enableZeroInputSearchHomeWeb||n.config.enableMruProviderInQF&&(n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType())===3},{dataSource:"Web",suggestionIsEnabled:(t,i)=>n.contains([0,13,14,10,5,1],i),requirements:[1,2]},{dataSource:"PP",suggestionIsEnabled:(n,t)=>t==1},{dataSource:"ANA",suggestionIsEnabled:(n,t)=>t==1&&(n=="ANAH"||n=="ANAR"||n=="ANATH"),requirements:[1,2],conditionalRequirements:()=>n.config.topHitMuse},l(!0,i.Web),],enabledDataSourcesForZeroInput:[{dataSource:"MRU",suggestionIsEnabled:(n,t)=>t==1},{dataSource:"MRS",suggestionIsEnabled:(n,t)=>t==0,conditionalRequirements:()=>n.config.enableZeroInputSearchHomeWeb||n.config.enableZIWebScopeMruDsb&&(n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType())!==1},{dataSource:"Web",requirements:[1,2],conditionalRequirements:()=>ht()},],webSyntheticEnabled:t=>t.queryToFetch&&n.isBingEnabled(),getEmptyZIMessages:()=>u(i.Web,"EmptyWebMessage","EmptyWebSubMessage")};n.ScopeConfig[i.PathCompletion]={icon:{content:"&#xE782",type:n.config.undocked?8:2,needsAccentColor:!0},scopeNameLocString:n.config.pathCompletionReplacesAll?"PathCompletionScopeName":null,prefixesLocString:null,enabledDataSources:[{dataSource:"PT"},{dataSource:"CG"},],enabledDataSourcesForZeroInput:[],getEmptyZIMessages:null};n.ScopeConfig[i.Emails]={icon:{content:"&#xE715",type:2},prefixesLocString:"ScopeEmails",enabledDataSources:[r("SSEE",1,!0),r("SSEC",2,!0),],enabledDataSourcesForZeroInput:[],showUpsellOnSuggestionsList:()=>a(),getEmptyZIMessages:()=>s(i.Emails,!1)};n.ScopeConfig[i.People]={icon:{content:"&#xE716",type:2},prefixesLocString:"ScopePeople",enabledDataSources:[r("SSUE",1,!0,()=>!(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.isTenantMsbEnabled())),r("SSUC",2,!0),l(!0),],enabledDataSourcesForZeroInput:[r("SSUE",1,!0,()=>hr()),r("SSUC",2,!0),],showUpsellOnSuggestionsList:()=>a(),getEmptyZIMessages:()=>s(i.People,!1)};n.ScopeConfig[i.Work]={icon:{content:"&#xE821",type:2},prefixesLocString:"ScopeWork",enabledDataSources:[r("SSUE",1,!0,()=>!(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.isTenantMsbEnabled())),r("SSUC",2,!0),l(!0),],enabledDataSourcesForZeroInput:[{dataSource:"DFLS",groupType:t.CuratedSuggestions,suggestionGroupToggler:c(t.CuratedSuggestions),conditionalRequirements:t=>n.canShowCuratedSuggestionInEnterpriseScope(t)},{dataSource:"MWS",groupType:t.MRUHistory,suggestionIsEnabled:()=>!0,conditionalRequirements:t=>n.canShowWorkSearchMru(t)},{dataSource:"MRU",groupType:t.MRUHistory,conditionalRequirements:t=>n.enableMRUSearchHome()&&n.canShowMruInWorkScopeZi(t)},{dataSource:"MPP",groupType:t.MRUHistory,conditionalRequirements:t=>n.enableMRUSearchHome()&&n.canShowMruInWorkScopeZi(t)},{dataSource:"MST",groupType:t.MRUHistory,conditionalRequirements:t=>n.enableMRUSearchHome()&&n.canShowMruInWorkScopeZi(t)},{dataSource:"MFF",suggestionIsEnabled:()=>!0,groupType:t.MRUHistory,conditionalRequirements:t=>n.enableMRUSearchHome()&&n.canShowMruInWorkScopeZi(t)},{dataSource:"MRS",groupType:t.MRUHistory,requirements:[1,2],conditionalRequirements:t=>n.enableMRUSearchHome()&&n.canShowMruInWorkScopeZi(t)},{dataSource:"MSBC",groupType:t.QuickWorkSearch,conditionalRequirements:t=>n.canShowQuickWorkSearch()&&n.canShowMsbSearchHomeInWorkScopeZi(t)},h("SSUE",t.RecommendedDocs,1,!0,t=>st()&&n.canShowMsbSearchHomeInWorkScopeZi(t)),],getEmptyZIMessages:()=>u(i.Work,"EmptyWorkMessage","EmptyWorkSubMessage")};n.ScopeConfig[i.EdgeUrls]={icon:{content:"&#xE81F",type:2},prefixesLocString:null,prefixes:["Edge","url","lucky"],enabledDataSources:[{dataSource:"ANA",suggestionIsEnabled:(n,t)=>t==1&&(n=="ANAH"||n=="ANAR"||n=="ANATH"),requirements:[1,2],conditionalRequirements:()=>n.config.topHitMuse}],enabledDataSourcesForZeroInput:[{dataSource:"ANA",suggestionIsEnabled:(n,t)=>t==1&&(n=="ANAH"||n=="ANAR"||n=="ANATH"),requirements:[1,2],conditionalRequirements:()=>n.config.topHitMuse}],getEmptyZIMessages:()=>u(i.EdgeUrls,"EmptyWebMessage","EmptyWebSubMessage")};n.ScopeConfig[i.Chat]={icon:{content:"&#xE901",type:2},prefixesLocString:"ScopeChat",enabledDataSources:[],enabledDataSourcesForZeroInput:[],getEmptyZIMessages:()=>["",""]};n.ScopeConfig[i.Copilot]={icon:{content:"&#xEAB1",type:2},prefixesLocString:"ScopeCopilot",enabledDataSources:[],enabledDataSourcesForZeroInput:[],getEmptyZIMessages:()=>["",""]};n.ScopeConfig[i.ThirdPartyWeb]={icon:{content:"&#xE774",type:1},prefixesLocString:"ScopeThirdPartyWeb",enabledDataSources:[{dataSource:"TPWeb",suggestionIsEnabled:(t,i)=>n.contains([1],i),requirements:[1]},],enabledDataSourcesForZeroInput:[{dataSource:"TPWeb",requirements:[1]},],getEmptyZIMessages:()=>u(i.Web,"EmptyWebMessage","EmptyWebSubMessage")};for(let t in n.ScopeConfig)n.ScopeConfig[t].enabledDataSources=n.ScopeConfig[t].enabledDataSources.filter(t=>n.contains(n.config.enabledDataSources,t.dataSource)),n.ScopeConfig[t].enabledDataSourcesForZeroInput=n.ScopeConfig[t].enabledDataSourcesForZeroInput.filter(t=>n.contains(n.config.enabledDataSources,t.dataSource))}function fr(){o=null}function at(t){let u=n.Host.getConnectedAccountInfo(0),f=n.Host.getConnectedAccountInfo(1),i=!!(u||f),r=t&&n.isBingEnabled();return i&&r?"EmptyScopeSearchLocation_PCCloudAndWeb":i?"EmptyScopeSearchLocation_PCAndCloud":r?"EmptyScopeSearchLocation_PCAndWeb":"EmptyScopeSearchLocation_PC"}function s(n,t){return u(n,`Empty${i[n]}Message`,`Empty${i[n]}SubMessage`,at(t))}function u(t,i,r,u){let f=vt(n.ScopeConfig[t]),e=u?n.Host.getLocString(u):"",o=n.Host.getLocString(i,f,e),s=n.Host.getLocString(r,f,e);return[o,s]}function er(){const t=n=>HitHighlightingParser.removeDiacritics(n.toLocaleLowerCase().trim());if(o={},n.RuntimeConfig.ScopesAvailable)for(let r in n.ScopeConfig){let f=parseInt(r),u=n.ScopeConfig[f];if(f!=i.All&&w(f,u)){if(f===i.Work&&or(u),n.isThirdPartySearchAllowed()&&f==i.ThirdPartyWeb){let r=n.Host.getThirdPartySearchApps();r.forEach(n=>{let r=t(n.displayName);o[r]||(o[r]=i.ThirdPartyWeb,u.prefixes=p(t(n.displayName)))});continue}if(!u.prefixes&&u.prefixesLocString){let t=n.Host.getLocString(u.prefixesLocString),i=n.Host.getEnUsLocString(u.prefixesLocString);u.prefixes=p(t,i)}u.prefixes&&u.prefixes.forEach(n=>o[t(n)]=f)}}}function or(t){(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isEduScopeApplicableFromStoredValue())?(t.prefixesLocString="ScopeSchool",t.icon=n.config.useCobaltCSS?{content:"&#xE82D",type:2}:{content:"&#xE736",type:2},t.getEmptyZIMessages=()=>u(i.Work,"EmptySchoolMessage","EmptyEduSubMessage")):(t.prefixesLocString="ScopeWork",t.icon={content:"&#xE821",type:2},t.getEmptyZIMessages=()=>u(i.Work,"EmptyWorkMessage","EmptyWorkSubMessage"));t.prefixes=null}function vt(t){if(t.scopeNameLocString)return n.Host.getLocString(t.scopeNameLocString);if(t.prefixes)return t.prefixes[0].trim();if(t.prefixesLocString){let i=t.prefixesLocString;n.isThirdPartySearchAllowed()&&!n.isSupportWebResultsInAllScopeInDMAEnabled()&&i==="ScopeAll"&&(i=n.isServicingSearchBingAs3PEnabled()?"DmaAllScopeName":"ScopeSearch");let r=p(n.Host.getLocString(i));return r[0].trim()}return""}function p(n,t){let i=n;return t&&(i+=","+t),i.search(k)>-1&&(i=i.replace(k,",")),i.split(",")}function sr(){return!!(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.qfUtils.isDocumentZeroQueryEnabled())}function hr(){return!(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.isTenantMsbEnabled())||!!n.config.msbEnablePeopleZQ}function w(t,r){if(n.shouldUseMsbEnterpriseScopes()){if(!n.contains(n.config.enabledScopesMsbEnterprise,i[t]))return!1}else if(!n.contains(n.config.enabledScopes,i[t]))return!1;if(n.config.noMailPeopleScopeInMsa&&(t==i.Emails||t==i.People)){let t=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();if(t!==3&&t!==0)return t===1}if(t==i.Web&&n.isWebResultsDisabled()||t==i.Chat&&(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.isEduTenant()))return!1;if(t==i.Chat&&n.isBingEnabled())return!0;if(t===i.Work)return!!(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isWorkScopeApplicable());if(t==i.ThirdPartyWeb&&n.isThirdPartySearchAllowed()||r.showUpsellOnSuggestionsList&&r.showUpsellOnSuggestionsList())return!0;if(t==i.ThirdPartyWeb)return n.isThirdPartySearchAllowed();let u=n.config.enabledDataSources.filter(n=>n!="MRU");n.isBingEnabled()&&t!=i.Web&&(u=u.filter(n=>n!="Web"));for(let n of r.enabledDataSources)kt(n,null)||(u=u.filter(t=>t!=n.dataSource));return r.enabledDataSources.some(t=>n.contains(u,t.dataSource))?!0:!1}function yt(t){switch(n.RuntimeConfig.QfMode){case 5:return n.ScopeConfig[i.All_FileExplorer];case 7:return n.ScopeConfig[i.All_SettingsApp];case 9:return n.ScopeConfig[i.All_ControlPanel];default:return n.ScopeConfig[b(t)]}}function lr(t,r,u,f,e){e||(e={});const{topHitRestriction:c,forceGroupOnTop:l,fromSearchHome:a,fromSuggestionType:v,inorganic:y,serpURLParams:p}=e;let o=n.baseParseQuery(t,r,c);o.fullPartialQuery=o.queryToFetch;o.scope=i.All;const h=n.Host===null||n.Host===void 0?void 0:n.Host.getMru3pAppCache();if(h){let t=o.originalQuery;n.config.skippingRemoveDiacriticsIndexerRelated||(t=HitHighlightingParser.removeDiacritics(o.originalQuery));let r=t.match(wt)||n.config.forwardSlashScopes&&t.match(bt);if(r){let[,,n]=r;n==(h===null||h===void 0?void 0:h.displayName)&&(o.scope=i.ThirdPartyWeb,o.thirdPartySearch=h)}}o.forceGroupOnTop=l;o.fromSuggestionType=v;o.fromSearchHome=a;o.inorganic=y;o.serpURLParams=p;let s;if(yr(o,f))o.taskFrame=f,o.isFormulatedQuery=!0,s=n.ScopeConfig[b(o)];else{if(o.fullPartialQuery&&(ar(o),u&&o.scope!=u.scope&&(o.isFormulatedQuery=!0)),o.isSearchHomeZI=!o.queryToFetch&&o.scope!=i.ThirdPartyWeb&&(n.RuntimeConfig.SearchHomeAvailable==1||n.RuntimeConfig.SearchHomeAvailable==2&&o.scope!=i.All),o.isWorkScopeZI=!o.queryToFetch&&o.scope===i.Work,o.isWebScopeZI=!o.queryToFetch&&o.scope===i.Web,o.isThirdPartyZI=n.isThirdPartySearchAllowed()&&!o.queryToFetch&&o.scope==i.ThirdPartyWeb&&!!o.thirdPartySearch,o.scope==i.All||o.scope==i.Web){let t=n.tryParseUrl(o.queryToFetch,!0);t&&t.type==0?(o.isProtocol=!0,o.fixedUrl=n.cleanAndFixUrlProtocol(t)):cr.test(o.queryToFetch)&&(o.isProtocol=!0,o.fixedUrl=n.cleanAndFixUrlProtocol(o.queryToFetch))}s=yt(o);let r=o.queryToFetch?s.enabledDataSources:s.enabledDataSourcesForZeroInput;o.availableDataSources={};for(let t of r)n.contains(n.config.enabledDataSources,t.dataSource)&&(o.availableDataSources[t.dataSource]=t);o.enabledDataSources={};for(let n in o.availableDataSources){let t=o.availableDataSources[n];t.suggestionGroupToggler&&t.suggestionGroupToggler.isHidden()||(o.enabledDataSources[n]=t)}let t=o.queryToFetch?s.staticGroupOrder:s.staticGroupOrderForZeroInput;t&&(o.staticGroupOrder=t(o))}return vr(o,s),o.showProgressBar=n.config.enableProgressBarForAllScope?n.config.dataSourcesWithProgressBar.some(n=>!!o.enabledDataSources[n]):n.isL2(o)&&n.config.dataSourcesWithProgressBar.some(n=>!!o.enabledDataSources[n]),o.equals=n=>{var t,r;return(o.queryToFetch?o.queryToFetch.toLowerCase():o.queryToFetch)==(n.queryToFetch?n.queryToFetch.toLowerCase():n.queryToFetch)&&n.scope==o.scope&&(n.scope!=i.ThirdPartyWeb||n.scope==i.ThirdPartyWeb&&((t=n.thirdPartySearch)===null||t===void 0?void 0:t.applicationUserModelId)===((r=o.thirdPartySearch)===null||r===void 0?void 0:r.applicationUserModelId))&&(n.taskFrame?n.taskFrame.raw:"")==(o.taskFrame?o.taskFrame.raw:"")&&n.topHitRestriction==o.topHitRestriction},o.getCacheKey=()=>o.cursorPosition+o.queryToFetch.toLocaleLowerCase()+o.scope+n.regionCache,o}function ar(t){if(n.RuntimeConfig.ScopesAvailable){let s=n.isDataSourceEnabled("PT",null),c=s&&pt.test(t.fullPartialQuery);if(c){t.canBePathCompletion=!0;t.scope=i.PathCompletion;return}let u=t.originalQuery;n.config.skippingRemoveDiacriticsIndexerRelated||(u=HitHighlightingParser.removeDiacritics(t.originalQuery));let h=u.match(wt)||n.config.forwardSlashScopes&&u.match(bt);if(h){let[,l,r,f]=h;r=r.toLocaleLowerCase();let e=r.trim();if(o&&n.contains(Object.keys(o),e)){if(t.scope=o[e],n.config.skippingRemoveDiacriticsIndexerRelated){const n=[i.Documents,i.Folders,i.Music,i.Videos,i.Photos];n.indexOf(t.scope)==-1&&(f=HitHighlightingParser.removeDiacritics(f))}t.queryToFetch=f;t.cursorPosition=Math.max(0,t.originalCursorPosition-l.length);n.mantainCursorPositionIn(t.queryToFetch,t.cursorPosition,n.cleanQuery,(n,i)=>{t.queryToFetch=n,t.cursorPosition=i});t.scope==i.ThirdPartyWeb&&(t.thirdPartySearch=n.Host.getThirdPartySearchAppByName(e));t.scopePrefix=r;t.isMultiWord=n.isMultiWord(t.queryToFetch);t.canBePathCompletion=s&&pt.test(t.queryToFetch)}}}}function kt(t,i){for(let i of t.requirements||[])switch(i){case 1:if(n.config.disableOfflineRequest&&!n.isBrowserOnline())return!1;break;case 2:if(n.isWebResultsDisabled())return!1;break;case 3:if(!n.isSupportWebResultsInAllScopeInDMAEnabled()||!n.isBrowserOnline())return!1}return t.conditionalRequirements&&!t.conditionalRequirements(i)?!1:!0}function vr(t,i){let r=n.RuntimeConfig.QfMode==5&&t.fullPartialQuery.search(":")>=0;if(r){t.enabledDataSources={};return}n.disableWebDataSourceIfNeeded(t,n.Host.getRegion(),n.Host.getLanguage());n.disableCoPiffDataSourcesOnConditions(t);let u=t.queryToFetch?i.enabledDataSources:i.enabledDataSourcesForZeroInput;for(let i of u)kt(i,t)||n.disableDataSources(t,i.dataSource);if(!t.queryToFetch){let i=!n.RuntimeConfiguration.DeviceHistoryEnabled;i&&n.disableDataSources(t,"PP","LRA","FL","LM","IFF")}n.TweakSearch&&n.TweakSearch.disableDataSourcesBasedOnTweakSearch(t);n.config.searchServiceDisabled&&n.disableDataSources(t,"IFF","IBA");!ct(t)||n.isMsbEnterprise()&&(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isQwsEnabled())||n.disableDataSources(t,"QSCH")}function yr(t,i){if(i){let r=i.scope,u=n.ScopeConfig[i.scope];if(w(r,n.ScopeConfig[r])){let f=n.ScopeConfig[r].enabledDataSources.filter(n=>gr(n.dataSource,i));if(f.length>0){for(let i of f)n.contains(n.config.enabledDataSources,i.dataSource)&&(t.enabledDataSources[i.dataSource]=i);return u}}}return null}function pr(t){let r=n.safeExecute(()=>JSON.parse(t),"parseTaskFrame");if(r){let n=kr(r);if(n!=i.All)return{raw:t,parsed:r,scope:n}}return null}function kr(n){switch(n.Uri){case wr:let r=n,t=r.FileType;if(t&&t.Value){if(t.Value=="Picture")return i.Photos;if(t.Value=="Video")return i.Videos}return i.Documents;case br:return i.Emails}return i.All}function b(n){return n?n.taskFrame?n.taskFrame.scope:n.scope:undefined}function dr(n){if(n.taskFrame){let t=n.taskFrame.parsed;if(t)if(n.taskFrame.scope==i.Emails){let n=t,i=n.Subject;if(i&&i.Value)return i.Value;let r=n.Body;if(r&&r.Value)return r.Value;let u=n.From&&n.From.length>0?n.From[0]:null;if(u&&u.Value)return u.Value;let f=n.To&&n.To.length>0?n.To[0]:null;if(f&&f.Value)return f.Value}else{let n=t,r=n.Title;if(r&&r.Value)return r.Value;let u=n.Body;if(u&&u.Value)return u.Value;let i=n.People;if(i&&i[0]&&i[0].Value)return i[0].Value;let f=n.Place;if(f&&f.Value)return f.Value}}return n.queryToFetch}function gr(n,t){if(t.scope==i.Emails)return n=="SSEC"||n=="SSEE";else{let r=t.parsed,i=r.FileSource?r.FileSource.Value:null;switch(n){case"MPVD":case"MDOC":case"MPHO":case"MVID":return i!="onedrive"&&i!="sharepoint";case"SSEE":return i!="thispc"&&i!="onedrive";default:return!1}}}function nu(){}function c(t){let i=""+t;const u=()=>{let t=n.LightweightStorage.getItem(dt)||"";return t.split(",")},r=t=>{let i=t.join(",");n.LightweightStorage.setItem(dt,i)};return{isHidden:()=>!1,toggle:t=>{n.safeExecute(()=>{let n=u();if(t&&n.every(n=>n!=i))n.push(i),r(n);else if(!t){let t=n.findIndex(n=>n==i);t>-1&&(n.splice(t,1),r(n))}},"GroupToggler.toggle")}}}let i;(function(n){n[n.All=0]="All";n[n.Apps=1]="Apps";n[n.Settings=2]="Settings";n[n.Photos=3]="Photos";n[n.Videos=4]="Videos";n[n.Music=5]="Music";n[n.Documents=6]="Documents";n[n.Folders=7]="Folders";n[n.Web=8]="Web";n[n.PathCompletion=9]="PathCompletion";n[n.Emails=10]="Emails";n[n.People=11]="People";n[n.Work=12]="Work";n[n.Chat=13]="Chat";n[n.Copilot=14]="Copilot";n[n.All_FileExplorer=1e3]="All_FileExplorer";n[n.All_Lockscreen=1001]="All_Lockscreen";n[n.All_SettingsApp=1002]="All_SettingsApp";n[n.All_ControlPanel=1003]="All_ControlPanel";n[n.EdgeUrls=1004]="EdgeUrls";n[n.ThirdPartyWeb=1e4]="ThirdPartyWeb"})(i=n.Scope||(n.Scope={}));let t;(function(n){n[n.Apps=0]="Apps";n[n.Settings=1]="Settings";n[n.Cortana=2]="Cortana";n[n.Command=3]="Command";n[n.Photos=4]="Photos";n[n.Videos=5]="Videos";n[n.Music=6]="Music";n[n.Documents=7]="Documents";n[n.Folders=8]="Folders";n[n.Emails=9]="Emails";n[n.Store=10]="Store";n[n.SearchSuggestions=11]="SearchSuggestions";n[n.PathCompletion=12]="PathCompletion";n[n._PowerBi=13]="_PowerBi";n[n.JumpListTasks=14]="JumpListTasks";n[n.JumpListPinned=15]="JumpListPinned";n[n.JumpListRecent=16]="JumpListRecent";n[n.JumpListFrequent=17]="JumpListFrequent";n[n.JumpListCustom=18]="JumpListCustom";n[n._JumpListActivityFeed=19]="_JumpListActivityFeed";n[n.People=20]="People";n[n._EdgeHistory=21]="_EdgeHistory";n[n.LocalPlaces=22]="LocalPlaces";n[n.Bookmarks=25]="Bookmarks";n[n.Related=26]="Related";n[n.Websites=27]="Websites";n[n.Contact=28]="Contact";n[n.JumpListSynthetic=29]="JumpListSynthetic";n[n.JumpListActions=30]="JumpListActions";n[n._StartMenu=31]="_StartMenu";n[n.LocalSearchHistory=32]="LocalSearchHistory";n[n.JumpListSettingsFaq=33]="JumpListSettingsFaq";n[n.JumpListSettingsRelatedSettings=34]="JumpListSettingsRelatedSettings";n[n.ActivityFeedSuggestions=35]="ActivityFeedSuggestions";n[n.TopApps=36]="TopApps";n[n.QuickSearch=37]="QuickSearch";n[n._LockscreenQuickSearch=38]="_LockscreenQuickSearch";n[n.WelcomeExperience=39]="WelcomeExperience";n[n.Upsell=40]="Upsell";n[n.MRUHistory=43]="MRUHistory";n[n.PromoBanner=44]="PromoBanner";n[n.VisualSearch=45]="VisualSearch";n[n._BingDailyImage=46]="_BingDailyImage";n[n._MeetingPrep=48]="_MeetingPrep";n[n.AnaheimDataList=49]="AnaheimDataList";n[n.RecommendedDocs=50]="RecommendedDocs";n[n.QuickWorkSearch=51]="QuickWorkSearch";n[n.QuickWorkSearchTopList=52]="QuickWorkSearchTopList";n[n.CuratedSuggestions=53]="CuratedSuggestions";n[n._RelatedMsbDocuments=54]="_RelatedMsbDocuments";n[n.AnaheimDataTile=55]="AnaheimDataTile";n[n.AnaheimDataTopHit=56]="AnaheimDataTopHit";n[n.DSBGroup=57]="DSBGroup";n[n.CuratedSettings=58]="CuratedSettings";n[n.ThreeFingerTap=59]="ThreeFingerTap";n[n.WorkSuggestions=60]="WorkSuggestions";n[n.Groups=61]="Groups";n[n.TrendingSearchData=62]="TrendingSearchData";n[n.MsbQuickWorkQueriesTopList=63]="MsbQuickWorkQueriesTopList";n[n.AnaheimDataQF=64]="AnaheimDataQF";n[n.BingChat=65]="BingChat";n[n.ChatWithBing=66]="ChatWithBing";n[n.FromYourHistory=67]="FromYourHistory";n[n.AIFeed=68]="AIFeed";n[n.SmartActions=69]="SmartActions";n[n.Copilot=70]="Copilot";n[n.DMAWeb=71]="DMAWeb";n[n.GroupHeader=104]="GroupHeader";n[n.MsbOnRampButton=105]="MsbOnRampButton";n[n.RSHSuggestions=106]="RSHSuggestions"})(t=n.GroupType||(n.GroupType={}));const k=/(\s*,\s*)|([\s]*[،„፡“፣"，]+[\s]*)/g,d=["PP","QP","IBA","TOPL","SMA"],g=["ST","QS","SSTS","CoPST"],nt=["SAPP","SPP"],tt=["LI","PSLI","CSLI","LV","MU"],it=["FL","PSFL","CSFL","LDOC","SDOC","FD","PSFD","CSFD","MFIL"].concat(tt),gt=[i.Documents,i.Folders,i.Photos,i.Videos,i.Music],ni=["LI","PSLI","CSLI"],ti=["FL","PSFL","CSFL","SDOC"],ii=["FD","PSFD","CSFD"],ri=["PSFL","CSFL","PSLI","CSLI","PSFD","CSFD"],ui=["PSFL","PSLI","PSFD","CSFL","CSLI","CSFD","CoPST"],fi=["ST","QS","SSTS"],ei=d.concat(g).concat(nt).concat(it).concat(["ANAH","ANAT","ANAR","ANAF","ANATH"]).concat(["PT","CG","DFLS","LURL","FEH","RSH"]),oi=1;n.isApp=si;n.isSetting=rt;n.isNonCopilotPoweredSetting=hi;n.isMedia=ci;n.isFileOrFolder=v;n.isPhoto=f;n.isDocument=e;n.isCopilotSuggestion=li;n.isFolder=y;n.isContentSearch=ai;n.isWindowsData=vi;n.isModelBasedSearchType=yi;n.isSameType=pi;n.isFileOrFolderScope=wi;n.isStore=bi;n.isFileWithCopilotAction=ut;n.isSuggestionWithCopilotAction=ki;n.isPowerPointSuggestion=di;n.isExcelSuggestion=gi;n.substrateProvidersEnabled=ft;n.searchHistoryAllowed=ht;n.isRecommendedDocsGroupEnabled=ct;n.nicerCloudFilesEnabled=rr;n.setZeroInputDataSourcesForL1=ur;n.populateScopeConfig=lt;lt();let o;n.cleanScopePrefixes=fr;n.initScopePrefixes=er;n.getScopeDisplayName=vt;n.isScopeEnabled=w;n.getScopeConfig=yt;n.isAADVerificationRequired=!1;const cr=/^ht+ps?[;:]+|^www[.。]|^\/+/,pt=/^[a-z]:\\|^%[^%]+%\\|^\\/i,wt=/^(([^:：]+)[:：]\s*)(.*)/,bt=/(\/(\w+)\s*)(.*)/;n.parseQuery=lr;n.parseTaskFrame=pr;const wr="action://FindMyStuff/FindDocument",br="action://FindMyStuff/FindMessage";n.getEffectiveScope=b;n.getEffectiveQuery=dr;const dt="HiddenSuggestionGroups";n.initQueryParser=nu}(WSB||(WSB={})),function(n){function lf(n,t){yi=n;pi=t}function ct(){return yi}function af(){return pi}function vf(n,t){return n.type==t.type&&n.source==t.source}function yf(t){if(n.config.useCobaltCSS)switch(t){case"WNSGPH":return"WSBEDG";case"WMSRPM":return"WMSMAN";case"WMSRPA":return"WMSAUT";case"WSBREW":return"WSREWF";case"WSBBST":return"WSBSTK";case"SBIWSB":return"WSVISS";case"BFBWSL":return"MSBWSL";case"BFBWPP":return"MSBWPP";case"BFBWMS":return"MSBWMS";case"MDSB10":return"MDSB11";case"EDSB10":return"EDSB11";case"WSBWS0":return"WSBWS1";case"WSHBSH":return"WSHBSH";case"WSBWSC":return"WSBWSD";case"BFBQWQ":return"MSBQWQ";case"DSBI10":return"DSBI11";case"DSBC10":return"DSBC11";case"SSHTRD":return"SHTR11";default:return t}return t}function wf(n){switch(n){case"PP":return"Apps";case"ST":return"Settings";case"FL":return"Files";case"LM":return"Media";default:return null}}function bf(n){switch(n){case"FL":case"LM":case"IFF":case"MFF":case"PT":case"CG":case"MPVD":case"MDOC":case"MFOL":case"MPHO":case"MVID":case"MMUS":case"FEH":case"CoPIFF":case"CoPCFP":return!0;case"OSTMA":case"OSTMAN":case"QS":case"PP":case"LRA":case"ST":case"MPP":case"MST":case"IBA":case"THST":case"TOPP":case"QSCH":case"DFLS":case"CUSE":case"QWQS":case"SMA":case"CoPST":case"RSH":return!1}throw new Error("New local data source "+n+" needs to be explicity classified as potentially containing PII or not");}function g(n){let t=l(n);return n.deviceItem&&n.handoffType==2?t+"\t"+n.deviceItem.id:n.handoffType==25?t+"\t"+n.converationId:t+"\t"+n.query}function gf(n,t){return n.msbDomain!=null&&n.msbDomain===t.msbDomain&&n.msbId!=null&&n.msbId===t.msbId}function ne(t,i,r){return t.scope===n.Scope.All&&i.staticGroupType===n.GroupType.DMAWeb&&r.staticGroupType===n.GroupType.DMAWeb}function te(t,i){return t.isSearchHomeZI&&d()&&gu(t)&&!n.config.msbQwsDocsNoRefreshAfterCachedResults&&i.staticGroupType===n.GroupType.RecommendedDocs&&(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isQwsEnabled())}function di(t,i){return t.targetPathLC&&n.isApp(t.type)&&n.isApp(i.type)&&t.targetPathLC.includes("\\installer\\")&&t.targetPathLC.endsWith(".ico")&&t.text==i.text}function gi(n,t){return n.handoffType==5&&n.actionUri=="ms-cortana://navigate/Settings"&&t.deviceItem&&t.deviceItem.id=="CortanaSettings"}function lt(n){let t=nt(n);return t?t.packageFamilyName:null}function nr(t,i,r){if(i){let i=rt(n.FOLDERID_Profile)+"\\onedrive - ",r=t.indexOf(i);if(r>=0){let n=t.indexOf("\\",r+i.length);t=t.substr(n+1)}}else{var u=n.AccessTokenManager.getWindowsIdentity();if(u&&t.startsWith("onedrive for business:\\")&&r){let n=u.indexOf("@");n!=-1&&r.toLocaleLowerCase().indexOf("personal/"+u.substr(0,n))>0&&(t=t.substr(23))}}return t}function tr(t,i,r){var u;let f="";if(r){let t=rt(n.FOLDERID_Profile)+"\\"+n.SubstrateTenantName.toLocaleLowerCase()+"\\",r=i.indexOf(t);if(r>=0){let n=r+t.length,u=i.indexOf(" - ",n);f=i.substr(n,u-n).toLocaleLowerCase();i=i.substr(u+3)}}else i.startsWith("sharepoint:\\")&&(i=i.substr(12),f=(u=t.siteTitle)===null||u===void 0?void 0:u.toLocaleLowerCase());return[i,f]}function ie(i,r,u){if((r.type=="TOPL"||r.type=="DFLS")&&i.isSearchHomeZI||te(i,r)||ne(i,r,u))return t.NotDuplicate;if(gf(r,u)||n.contains([5,4],r.handoffType)&&n.contains([5,4],u.handoffType)&&r.actionUri==u.actionUri&&r.query.toLocaleLowerCase()==u.query.toLocaleLowerCase()||r.handoffType==10&&u.handoffType==10&&r.type==u.type&&!r.htmlContent&&!u.htmlContent&&r.query.toLocaleLowerCase()==u.query.toLocaleLowerCase()||r.type!="PWL"&&r.handoffType==1&&u.handoffType==1&&n.isDuplicateUrl(i,r.url,u.url))return t.NoMetadata;let o=nt(r),s=nt(u),f,e;f=o?o.filePath:r.path;f&&(f=f.toLocaleLowerCase());e=s?s.filePath:u.path;e&&(e=e.toLocaleLowerCase());let h=lt(r),c=lt(u);if(h&&c&&h.toLocaleLowerCase()==c.toLocaleLowerCase())return t.NoMetadata;let l=at(r),v=at(u);if(l&&s||v&&o){let i=f||e,n=l||v,r=n.encodedPath;if(i&&r&&i==r.toLocaleLowerCase()){let i=o||s;return!n.launchArguments||(i.launchArguments||"").toLocaleLowerCase()==n.launchArguments.toLocaleLowerCase()||!i.launchArguments&&n.launchArguments&&i.displayName.toLocaleLowerCase().startsWith(n.displayName.toLocaleLowerCase())?t.NoMetadata:t.NotDuplicate}return t.NotDuplicate}if(r.deviceItem&&u.deviceItem){let i=r.deviceItem.id||"",h=u.deviceItem.id||"";if(n.isSetting(r.type)&&n.isSetting(u.type)&&(i=r.deviceItem.displayName,h=u.deviceItem.displayName),i.toLocaleLowerCase()==h.toLocaleLowerCase())return f&&!o&&e&&!s?t.MergeMetadata:t.NoMetadata;if(o){if(n.isSetting(u.type)&&bi[i]==h)return t.NoMetadata}else if(n.isSetting(r.type)&&(s&&bi[h]==i||n.isSetting(u.type)&&(ki[i]==h||ki[h]==i)))return t.NoMetadata}if(di(r,u)||di(u,r))return t.NoMetadata;if(f&&e){if(f==e)return t.MergeMetadata;if(!o&&!s)if(r.handoffType==u.handoffType){if(r.handoffType==8&&r.url==u.url)return t.MergeMetadata}else{const i=r.type==="MFIL"||u.type==="MFIL",o=r.handoffType!=8&&!a(r),s=u.handoffType!=8&&!a(u);if(f=nr(f,o,r.url),e=nr(e,s,u.url),f==e)return i?t.NoMetadata:t.MergeMetadata;if(n.SubstrateTenantName){let[n,c]=tr(r,f,o),[h,l]=tr(u,e,s);if(c==l&&(h.endsWith(n)||n.endsWith(h)))return i?t.NoMetadata:t.MergeMetadata}}let i=r.targetPathLC,h=u.targetPathLC;if(o&&u.type=="IBA"&&(f=dt(f)),s&&r.type=="IBA"&&(e=dt(e)),(i&&h&&i==h||i&&i==e||h&&f==h||f==e)&&(!o||!s||(o.launchArguments||"").toLocaleLowerCase()==(s.launchArguments||"").toLocaleLowerCase()))return t.NoMetadata}if(gi(r,u)||gi(u,r)||r.type==="PPL"&&u.type==="PPL"&&r.uniqueName&&u.uniqueName&&r.uniqueName.toLocaleLowerCase()===u.uniqueName.toLocaleLowerCase()||r.type==="OLE"&&u.type==="OLE"&&r.internetMessageId===u.internetMessageId||r.type==="BKS"&&u.type==="BKS"&&r.url&&u.url&&r.url===u.url)return t.NoMetadata;if((n.VelocityKeys===null||n.VelocityKeys===void 0?void 0:n.VelocityKeys.isFeatureEnabled(55758958))&&n.config.enableVegaProviderDedupe&&(r.isVegaMatched||u.isVegaMatched)){const n=r.url,i=u.url;if(n&&i&&n===i)return t.NoMetadata}return t.NotDuplicate}function re(t,i){if(n.isDocument(t===null||t===void 0?void 0:t.type)&&n.isDocument(i===null||i===void 0?void 0:i.type)&&t.deviceItem&&i.deviceItem){let n=t.deviceItem.id,r=i.deviceItem.id;if(!o(n)&&!o(r)&&n.toLocaleLowerCase()==r.toLocaleLowerCase())return!0}return!1}function ue(n){switch(n){case"MFF":case"FL":case"LM":case"IFF":case"MPVD":case"MDOC":case"MPHO":case"MVID":case"MMUS":case"MFOL":case"CoPIFF":return!0;default:return!1}}function fe(t,i){if(!n.IndexerQueryGenerator)return!1;if(n.RuntimeConfig.QfMode==5)return!0;switch(t){case"IBA":case"MPVD":case"MDOC":case"MPHO":case"MVID":case"MMUS":case"MFOL":case"CoPIFF":return!0;case"IFF":return sr(i)||!n.config.minLengthForIBAonL1||i.queryToFetch.length>=n.config.minLengthForIBAonL1;default:return!1}}function ee(t,i,r,u){if(r!="Exchange"){let o;const s=decodeURI(t.url),h=i.toLocaleLowerCase(),c=s.toLocaleLowerCase().indexOf(h);if(c!=-1){let n=s.substr(0,c-1);h.endsWith(".one")&&(n=n.substr(0,n.lastIndexOf("/")));o=encodeURI(n)}else o=t.url;let f=s.split("/").slice(3),e;r==null?e="":r=="OneDriveBusiness"?(e="OneDrive for Business:\\",f.length>2&&f[0].toLocaleLowerCase()=="personal"&&f[2].toLocaleLowerCase()=="documents"&&(f=f.slice(3))):e="SharePoint:\\";h.endsWith(".one")&&f.splice(f.length-2,1);t.path=e+f.join("\\");u&&(r=="OneDriveBusiness"?e=n.Host.getLocString("OneDriveTitle",t.siteTitle):(e=t.siteTitle,f.length>1&&f[0].toLocaleLowerCase()=="teams"&&(f=f.slice(2))),t.prettyPrintedPath=e+" > "+f.join(" > "));o&&(t.locationUrl=o)}}function oe(n){return n.kind=="Modern Setting"}function nt(t){return n.isApp(t.type)?t.deviceItem:null}function se(n){return!!n.suggestions}function he(t){return n.config.useCobaltCSS&&(y(t)||h(t))}function ce(n){return n.deviceItem}function at(n){return n.type=="CG"?n.deviceItem:null}function le(t){return n.isApp(t.type)||n.isSetting(t.type)||n.isFileOrFolder(t.type)&&!yr(t.type)}function ae(t){const i=l(t);return i==n.GroupType.WorkSuggestions||i==n.GroupType.Bookmarks||i==n.GroupType.People||i==n.GroupType.Documents}function l(t,i){if(typeof t.staticGroupType=="number")return t.staticGroupType;switch(t.type){case"TOPL":return n.GroupType.TopApps}if(n.isApp(t.type))return n.GroupType.Apps;if(vt(t))return t.groupType;if(n.isSetting(t.type))return n.GroupType.Settings;if(n.isPhoto(t.type))return n.GroupType.Photos;switch(t.type){case"CG":return n.GroupType.Command;case"PT":return n.GroupType.PathCompletion;case"LV":return n.GroupType.Videos;case"MU":return n.GroupType.Music;case"JL":case"FL":case"PSFL":case"CSFL":case"LDOC":case"SDOC":case"SDFE":case"MFIL":return n.GroupType.Documents;case"FD":case"PSFD":case"CSFD":return n.GroupType.Folders;case"OLE":case"OWA":return n.GroupType.Emails;case"PPL":case"MPPL":return n.GroupType.People;case"MGRP":return i===n.Scope.Work?n.GroupType.Groups:n.GroupType.People;case"BKS":case"MBKS":case"MQNA":case"MBLD":case"MACR":return n.GroupType.Bookmarks;case"ELA":return n.GroupType.LocalPlaces;case"ANAF":case"ANAH":case"ANAT":case"ANAR":return n.GroupType.SearchSuggestions;case"HS":return n.config.enableFromYourHistory?n.GroupType.FromYourHistory:t.staticGroupType===n.GroupType.ChatWithBing?n.GroupType.ChatWithBing:n.GroupType.SearchSuggestions;case"ANATH":return n.GroupType.AnaheimDataTopHit;case"FEH":return n.GroupType.LocalSearchHistory;case"SNSC":case"SNSP":case"SNST":return n.GroupType.VisualSearch;case"RSSG":case"QSSG":case"QWQS":case"QWQA":case"QWQC":return n.GroupType.QuickSearch;case"TS":return n.GroupType.TrendingSearchData;case"SMA":return n.GroupType.SmartActions;case"TP":return n.GroupType.DMAWeb;case"RSH":return n.GroupType.RSHSuggestions;default:switch(t.handoffType){case 3:return n.GroupType.Store;case 5:case 4:return n.GroupType.Cortana;case 10:return t.htmlContent?n.GroupType.SearchSuggestions:n.GroupType.Cortana;case 0:return t.staticGroupType===n.GroupType.ChatWithBing?n.GroupType.ChatWithBing:n.GroupType.SearchSuggestions;case 13:case 14:return n.GroupType.SearchSuggestions;case 21:return n.GroupType.WorkSuggestions;case 1:return n.GroupType.Websites;case 26:return n.GroupType.Copilot;case 25:return n.GroupType.AIFeed}throw new Error("Unexpected handoff type: "+t.handoffType);}}function ir(n){return!n.isAnswer&&(n.handoffType==0||n.handoffType==11||n.handoffType==21)&&n.type!="QSSG"}function rr(n){return n.type=="HS"}function ve(n){return ir(n)||rr(n)||(n===null||n===void 0?void 0:n.isAnswer)}function ur(t){switch(t){case n.GroupType.JumpListTasks:case n.GroupType.JumpListPinned:case n.GroupType.JumpListRecent:case n.GroupType.JumpListFrequent:case n.GroupType.JumpListCustom:return!0;default:return!1}}function ye(t){let i=t.type;return ur(i)||i==n.GroupType.Related||i==n.GroupType.Contact}function vt(n){return!!n.isChild||!!n.parent}function pe(n){return n.type=="JL"}function we(t){switch(t){case n.GroupType.Apps:case n.GroupType.Store:return n.Scope.Apps;case n.GroupType.Settings:return n.Scope.Settings;case n.GroupType.Documents:return n.Scope.Documents;case n.GroupType.Folders:return n.Scope.Folders;case n.GroupType.Photos:return n.Scope.Photos;case n.GroupType.Videos:return n.Scope.Videos;case n.GroupType.Music:return n.Scope.Music;case n.GroupType.LocalPlaces:case n.GroupType.SearchSuggestions:case n.GroupType.FromYourHistory:case n.GroupType.ChatWithBing:case n.GroupType.AnaheimDataQF:case n.GroupType.Websites:case n.GroupType.Bookmarks:return n.Scope.Web;case n.GroupType.Emails:return n.Scope.Emails;case n.GroupType.People:return n.Scope.People;case n.GroupType.AnaheimDataTopHit:if(n.config.topHitMuse)return n.Scope.EdgeUrls;break;case n.GroupType.BingChat:return n.Scope.Chat;case n.GroupType.Copilot:return n.Scope.Copilot}return n.Scope.All}function fr(t){switch(t){case 0:case 7:case 8:return 32;case 1:return 16;case 2:return n.IconSize_GridLayout_Scaled;case 3:return 24;case 4:return 64;case 5:return 200;case 9:return 256}}function be(n,t,i,r){if(n&&n.type==0&&cr(t,r)){let r=t=>{n.ratio=t.height==t.width?1:t.height>t.width?3:2,i()},t=new Image;t.src=n.content;t.onload=()=>r({height:t.height,width:t.width})}else i()}function ke(t){return`${n.config.imageHostName}${t}`}function yt(){let t=n.uiLanguageCache.toLocaleLowerCase();return de[t]||t}function er(n,t,i,r,u,f,e,o,s,h,c,l,a,v){let y={text:t,getIcon:i,icon:r,type:u,query:f,ciMatchedQuery:null,id:c,click:l,handoffType:o,instItem:e,isAnswer:!1,htmlContent:null,classNames:[],selected:!1,featureStore:undefined,sequenceNumber:s,getMruData:()=>null,template:0,mayContainPII:h,features:[],previewPaneType:undefined,reactKey:v};return y.previewPaneType=wt(n,y,a),y}function ge(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){let it=[];if(g)try{it=JSON.parse(g)}catch(rt){vi("parseChildSuggestions",null,new Error(rt))}let tt={text:t,getIcon:i,icon:r,type:u,query:f,ciMatchedQuery:null,id:undefined,click:undefined,handoffType:o,instItem:e,isAnswer:y,htmlContent:null,classNames:[],selected:!1,featureStore:undefined,sequenceNumber:s,getMruData:()=>et(tt),template:d,mayContainPII:h,features:[],previewPaneType:p,subType:c,additionalInfoText:l,primaryMetadata:a,autoOpenPreviewPaneWhenOnTopHit:v,secondaryIcon:w,segments:b,narratorText:k,childSuggestions:it,webUrl:nt},ut=tt===null||tt===void 0?void 0:tt.isChild;return tt.previewPaneType=ut?wt(n,tt,!0):wt(n,tt,!1),tt}function no(n,t,i,r,u,f,e,o,s){n.subItems==null&&(n.subItems=[]);let c=n.id,h={id:t,sequenceNumber:n.sequenceNumber,selected:!1,text:i,itemView:r,props:u,onSelected:o,click:s,disabled:e,instItem:f,suggestionId:c};return n.subItems.push(h),h}function to(t,i,r,u,f,e,o,s){let h=n.InstrumentationHelper.getInstrumentedSyntheticSuggestion(i,r);if(h)return h;let l=t.scope;h=er(t,null,null,u,r,null,n.InstrumentedItem.getNonSuggestionInstrumentedItem(r,wi.KValues),f,i,!1,r);h.notAResult=!0;h.primaryMetadata=e;o&&(h.additionalInfoText=" - "+h.primaryMetadata);let c=n=>{var t;h.query=n.queryToFetch;h.text=HitHighlightingParser.addMarkers(n.queryToFetch);h.narratorText=or(h);h.click=()=>s(h,n);h.reactKey=r+n.queryToFetch+((t=h.primaryMetadata)!==null&&t!==void 0?t:"")};return c(t),h.updateFromQuery=n=>!n.isProtocol&&n.scope==l&&n.queryToFetch?(c(n),!0):!1,h.getMruData=()=>et(h),n.InstrumentationHelper.instrumentSyntheticSuggestion(i,h),h}function or(n,t){if(n.htmlContent)return null;let i=[n.text],r=n.dateShort;if(r&&i.push(r),t)i.push(t);else{if(n.primaryMetadata){i.push(n.primaryMetadata);let t=n.department;t&&i.push(t)}n.template==1&&n.secondaryMetadata&&i.push(n.secondaryMetadata)}return HitHighlightingParser.removeMarkers(i.join(", "))}function sr(t){return(t===null||t===void 0?void 0:t.scope)!=n.Scope.All||!!(t===null||t===void 0?void 0:t.taskFrame)}function hr(t){return typeof t=="string"?t=="LI"||t=="LV"||t=="PSLI"||t=="CSLI":t==n.GroupType.Photos||t==n.GroupType.Videos}function io(t,i){return typeof t=="string"?n.isDocument(t)&&i==2:t==n.GroupType.Documents&&i==2}function cr(t,i){return hr(t)||vr(t)||n.config.newFilesPreviewPane&&io(t,i)}function ro(t){return!n.config.disableMediaGridLayout&&!n.RuntimeConfig.AlwaysWide&&hr(t)}function uo(t,i){if(!t||!n.RuntimeConfig.ScopesAvailable)return null;if(i.scope==n.Scope.All){let r=[];if(t.ISUPN&&t.ISUPG){let n=t.ISUPN.split("\t"),i=t.ISUPG.split("\t");if(n.length==i.length)for(let t=0;t<n.length;t++)r.push(i[t]+"\t"+n[t]);else vi("parseWebSuppressionSignals",null,new Error("parsedNames.length != parsedGroups.length"))}let i=t.FSUP?t.FSUP.split("\t"):null;if(n.config.disableFSUPForWebSuggGroup&&i){let t=i.indexOf(n.GroupType.SearchSuggestions.toString());t!==-1&&i.splice(t,1)}if(n.config.enableWinStoreAppPreview&&i){let t=i.indexOf(n.GroupType.Store.toString());t!==-1&&i.splice(t,1)}return{fullySuppressedGroups:i,partiallySuppressedGroups:t.PSUP?t.PSUP.split("\t"):null,suppressedSuggestions:r}}return null}function fo(t){return tt||(tt=_d.createElement("span")),n.safeExecute(()=>(tt.innerHTML=t,tt.innerText),t,"decodeHtml")}function eo(n,t){return{matchType:n,matchedText:t}}function e(n){return n.replace(oo,"\\$&")}function so(t,i){if(i){let r=n.config.disableSyntaxHighlight?t.toLocaleLowerCase().includes(i.toLocaleLowerCase()):t.includes(HitHighlightingParser.startMarker),f=r?t:HitHighlightingParser.addMarkers(t,i),u=HitHighlightingParser.split(f).find(n=>n.highlighted);if(u){let o=r?HitHighlightingParser.removeMarkers(t):t,s=n.config.disableSyntaxHighlight?new RegExp("((?:\\\\[^\\\\]+)?\\\\[^\\\\]+)?\\\\("+e(i)+"|"+e(i.toLocaleLowerCase())+").*","i"):new RegExp("((?:\\\\[^\\\\]+)?\\\\[^\\\\]+)?\\\\"+e(u.text)+".*","i"),f=s.exec(o);if(f&&f[0])return{matchType:pt.Location,matchedText:o.startsWith(f[0])?o:String.fromCharCode(8230)+f[0]}}}return null}function ho(t,i){if(i){let r=n.config.disableSyntaxHighlight?t.toLocaleLowerCase().includes(i.toLocaleLowerCase()):t.includes(HitHighlightingParser.startMarker),f=r?t:HitHighlightingParser.addMarkers(t,i),u=HitHighlightingParser.split(f).find(n=>n.highlighted);if(u){let o=r?HitHighlightingParser.removeMarkers(t):t,s,h=n.config.disableSyntaxHighlight?new RegExp("(?:\\S+\\s){0,3}\\b("+e(i)+"|"+e(i.toLocaleLowerCase())+")\\S*(?:\\s\\S+){0,5}","i"):new RegExp("(?:\\S+\\s){0,3}\\b"+e(u.text)+"\\S*(?:\\s\\S+){0,5}","i"),f=h.exec(o);return f&&f[0]&&(s={matchType:pt.Content,matchedText:f[0]}),[o,s]}}return[null,null]}function co(t,i){return!t||!i?!1:n.config.disableSyntaxHighlight?HitHighlightingParser.addMarkers(t,i).toLocaleLowerCase().includes(i.toLocaleLowerCase()):HitHighlightingParser.addMarkers(t,i).includes(HitHighlightingParser.startMarker)}function lo(t){return t==n.Scope.Emails}function ao(t,i){if(n.config.consistentHighlightInQF&&!i)return n.config.reverseHighlightInQF;if(vt(t))return!1;switch(t.handoffType){case 0:case 13:case 14:case 21:case 5:case 10:case 4:return t.type!="QSSG";case 3:return t.type=="STS";case 2:return t.type=="SDFE";case 8:case 12:return t.type=="OWA";default:return!1}}function wt(t,i,r){const u=undefined;if(!n.RuntimeConfig.PreviewPaneAvailable||t.isSearchHomeZI)return u;const f=()=>{if(i.handoffType==1)return uf()?1:n.RuntimeConfig.AlwaysWide?2:u;return n.isBingEnabled()&&n.contains([0,13,14],i.handoffType)&&!i.htmlContent?1:u};if(r)return f();switch(l(i,t===null||t===void 0?void 0:t.scope)){case n.GroupType.Store:return n.RuntimeConfig.AlwaysWide&&i.type!="STS"?2:u;case n.GroupType.Apps:case n.GroupType.Cortana:case n.GroupType.Command:case n.GroupType.Folders:case n.GroupType.Music:case n.GroupType.PathCompletion:case n.GroupType.Emails:case n.GroupType.Photos:case n.GroupType.Settings:case n.GroupType.Videos:case n.GroupType.Copilot:return n.RuntimeConfig.AlwaysWide?2:u;case n.GroupType.Documents:return a(i)?3:n.RuntimeConfig.AlwaysWide?2:u;case n.GroupType.People:return i.handoffType==0?1:i.handoffType==1?u:a(i)?3:n.RuntimeConfig.AlwaysWide?2:u;case n.GroupType.Groups:return 3;case n.GroupType.Bookmarks:return a(i)?3:f();case n.GroupType.Websites:return n.isBingEnabled()&&i.type!="LURL"?1:u;case n.GroupType.AnaheimDataTopHit:return n.config.topHitMuse?2:f();default:return f()}}function vo(t,i,r){let u=r.previewPaneType;if(!u)return!1;let f=i.previewPaneType,e=u==1&&f==1,o=!0;return n.config.msbVerticalWorkScopeEnabled&&r.handoffType===21&&(o=i.msbVerticalHash===r.msbVerticalHash),i.query.toLocaleLowerCase()==r.query.toLocaleLowerCase()&&(!e&&u==f||e&&i.handoffType==r.handoffType)&&o}function o(n){return n==null}function po(t){return t==n.GroupType.Documents&&n.isSubstrateO365AccountConnected}function wo(t){switch(t){case 2:return"OneDrive";case 3:return n.Host.getLocString("OneDriveForBusiness");case 4:return"SharePoint";case 1:return n.Host.getLocString("ThisPC");case 5:return n.Host.getLocString("MsbPeopleGroups");case 6:return n.Host.getLocString("MsbPeopleContacts")}return null}function bo(n){if(br())switch(n){case 37:return 39;case 39:return 37}return n}function lr(){return n.config.wsbWithCopilotQF?{type:0,content:n.getEdgeFallbackIcon()}:n.config.enableEdgeIconForWebSuggInQF?{type:0,className:"EdgeIconForWebSugg"}:n.config.networkIconForWebSugg?{type:0,className:"NetworkIcon"}:n.config.networkWithSpyglassIconForWebSugg?{type:0,className:"NetworkWithSpyglassIcon"}:n.config.bingIconForWebSugg?{type:0,className:"BingIcon"}:n.config.enableBlueSearchBPForWebSuggestion||n.config.enableSolidSearchForWebSuggestion?{content:n.Host.getWindowsTheme()==2?n.config.qfWebSuggestionIconUrlDark:n.config.qfWebSuggestionIconUrlLight,type:0,isWebSuggestionIcon:!0}:{content:"&#xE721",type:2}}function ko(t){return n.Host.getLocString(t?(n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.isEduTenant())?"SeeSchoolAndWebResults":"SeeWorkAndWebResults":iu()?"SeeBingChatResults":ar())}function ar(){return n.config.addOpenPrefixToOnlineSuggestion?"OpenWebResults":n.config.enableNewWebSuggestionAnnotation?n.config.webSuggestionAnnotationKey:"SeeWebResults"}function go(t){return n.msbHost&&n.isDataSourceEnabled("MSBC",t)}function vr(n){return n=="PPL"||n=="MPPL"||n=="MGRP"}function yr(n){return n=="MFIL"}function ns(){const t=n.config.msbSuggestionTophitRule;switch(t){case 1:return kf;case 2:default:return df}}function ts(n){return n=="MPPL"||n=="MGRP"||n=="MBKS"||n=="MQNA"||n=="MFIL"||n=="MBLD"||pr(n)}function pr(n){return n=="MVALL"||wr(n)}function wr(n){return n=="MVPPL"||n=="MVGRP"||n=="MVSIT"||n=="MVFIL"||n=="MVMES"||n=="MVYAM"||n=="MVCON"}function is(n){switch(n){case"MVPPL":return"MPPL";case"MVGRP":return"MGRP";case"MVFIL":return"MFIL";default:return undefined}}function a(n){return n.handoffType===17}function rs(n,t){const i="b_hide";n&&(t?n.classList.remove(i):n.classList.add(i))}function us(t,i){if(!n.config.limitScaleRange){const r="fixedHeightWin11";t&&(i?t.classList.add(r):t.classList.remove(r))}}function it(n,t){n instanceof HTMLElement&&(n.style.width=t)}function fs(t,i,r){if(t){const{TextScaleFactor:f}=n.RuntimeConfiguration,u=f>1,e=n.config.useCobaltCSS;if(i)if(r)u?t.getAttribute("style")||(it(t.querySelector(".dsb-fwp-left"),"57.1%"),t.querySelector(".dsb-fwp-left").style.marginRight="2.2%",it(t.querySelector(".dsb-fwp-right"),"40.7%")):(t.querySelector(".dsb-fwp-left").removeAttribute("style"),t.querySelector(".dsb-fwp-right").removeAttribute("style"));else if(u){if(!t.getAttribute("style")){const n=e?"59.32%":"53.31%";it(t,n)}}else t.removeAttribute("style")}}function br(){return ThresholdUtilities.isRightToLeftLanguage(n.uiLanguageCache)}function es(){bt={}}function rt(t){let i=bt[t];if(typeof i=="undefined"){let r=SearchAppWrapper.CortanaApp.queryFormulationView.deviceSearch;r.getFolderPathFromKnownFolderIdGuid?(i=n.safeExecute(()=>r.getFolderPathFromKnownFolderIdGuid(t),"getPathFromFolderID","",t),i=i.toLocaleLowerCase()):i="";bt[t]=i}return i}function os(){kt={}}function dt(n){if(!n.startsWith("{"))return n;let t=kt[n];if(!t){let i=n.match(ss);t=i?rt(i[1])+i[2]:n;kt[n]=t}return t}function hs(n){return n.startsWith("file:")&&(n=n.slice(5)),n.replace(/\//g,"\\")}function cs(t){return n.config.enforceOriginalOrderForTypes[t.type]||n.config.enforceOriginalOrderForTypes[t.type+"|"+t.handoffType]}function ls(t){return t==1?"https://s